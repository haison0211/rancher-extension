"use strict";(("undefined"!==typeof self?self:this)["webpackChunkrancher_pod_metrics_1_0_0"]=("undefined"!==typeof self?self:this)["webpackChunkrancher_pod_metrics_1_0_0"]||[]).push([[120],{10120:function(e,t,r){r.d(t,{fetchPodMetrics:function(){return f}});var n=r(4364);function s(e){if(!e||"string"!==typeof e)return 0;const t=e.trim();if(!t)return 0;if(t.endsWith("n")){const e=parseFloat(t.slice(0,-1));return isNaN(e)?0:e/1e6}if(t.endsWith("m")){const e=parseFloat(t.slice(0,-1));return isNaN(e)?0:e}{const e=parseFloat(t);return isNaN(e)?0:1e3*e}}function i(e){if(!e||"string"!==typeof e)return 0;const t=e.trim();if(!t)return 0;const r={Ki:1/1024,Mi:1,Gi:1024,Ti:1048576,K:1/1024/1.024,M:1/1.024,G:1e3,T:1024e3};for(const[s,i]of Object.entries(r))if(t.endsWith(s)){const e=parseFloat(t.slice(0,-s.length));return isNaN(e)?0:e*i}const n=parseFloat(t);return isNaN(n)?0:n/1048576}function a(e){if(!e||0===e)return"0.00 vCPU";const t=e/1e3;return`${t.toFixed(2)} vCPU`}function o(e){return e?e>=1024?`${(e/1024).toFixed(2)} GiB`:`${e.toFixed(0)} MiB`:"0 MiB"}function c(e){let t=0,r=0;if(!e||!e.containers||!Array.isArray(e.containers))return{cpu:0,memory:0,cpuDisplay:"0.00 vCPU",memoryDisplay:"0 MiB"};for(const n of e.containers)n&&n.usage&&(t+=s(n.usage.cpu),r+=i(n.usage.memory));return{cpu:t,memory:r,cpuDisplay:a(t),memoryDisplay:o(r)}}async function f(e,t,r){const s=new Map;if(!e||!t)return n.error("Invalid parameters for fetchPodMetrics"),s;try{const n=`/k8s/clusters/${t}/apis/metrics.k8s.io/v1beta1`,i=r?`${n}/namespaces/${r}/pods`:`${n}/pods`,a=await e.get(i),o=a.data;if(o&&o.items&&Array.isArray(o.items))for(const e of o.items)if(e.metadata&&e.metadata.namespace&&e.metadata.name){const t=`${e.metadata.namespace}/${e.metadata.name}`;s.set(t,c(e))}}catch(i){const e=i.message||"Unknown error";n.error("Failed to fetch pod metrics:",e)}return s}}}]);
//# sourceMappingURL=rancher-pod-metrics-1.0.0.umd.min.120.js.map