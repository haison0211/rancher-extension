(("undefined"!==typeof self?self:this)["webpackChunkrancher_pod_metrics_1_0_0"]=("undefined"!==typeof self?self:this)["webpackChunkrancher_pod_metrics_1_0_0"]||[]).push([[732],{2271:function(e,t,a){var r=a(29535);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("1235fbab",r,!0,{sourceMap:!1,shadowMode:!1})},2517:function(e,t,a){"use strict";a.d(t,{A:function(){return p}});var r=a(14220),s=a(9274),n=a(59136),i=a(99726),o=a(8135),l=a(68851),c=a(35664),u=a(79401),d=a(4364),h={name:"CreateEditView",mixins:[o.Ay],emits:["done"],data(){return{errors:[]}},computed:{isCreate(){return this.mode===r.YQ},isEdit(){return this.mode===r.G5},isView(){return this.mode===r.nW},schema(){const e=this.storeOverride||this.$store.getters["currentStore"](this.value.type);return this.$store.getters[`${e}/schemaFor`](this.value.type)},isNamespaced(){return this.schema?.attributes?.namespaced||!1},labels:{get(){return this.value?.labels},set(e){this.value.setLabels(e)}},annotations:{get(){return this.value?.annotations},set(e){this.value.setAnnotations(e)}},doneRoute(){if(this.value?.doneRoute)return this.value.doneRoute;let e=this.$route.name;return e?.endsWith("-id")?e=e.replace(/(-namespace)?-id$/,""):e?.endsWith("-create")&&(e=e.replace(/-create$/,"")),e},doneParams(){if(this.value?.doneParams)return this.value.doneParams;const e={...this.$route.params};return delete e.namespace,delete e.id,e}},methods:{done(){if(!this.doneEvent)return this.doneLocationOverride?this.$router.replace(this.doneLocationOverride):void(this.doneRoute&&this.$router.replace({name:this.doneRoute,params:this.doneParams||{resource:this.value.type}}));this.$emit("done")},async conflict(){return await(0,u.Rq)(this.initialValue,this.value,this.liveValue,{dispatch:this.$store.dispatch,getters:this.$store.getters},this.storeOverride||this.$store.getters["currentStore"](this.value.type))},async save(e,t,a=0){this.errors&&(0,l.IU)(this.errors);try{if(await this.applyHooks(o.Fm,this.value),this.value?.metadata?.labels&&0===Object.keys(this.value.metadata.labels||{}).length&&delete this.value.metadata.labels,this.value?.metadata?.annotations&&0===Object.keys(this.value.metadata.annotations||{}).length&&delete this.value.metadata.annotations,this.isCreate){const e=this.value?.metadata?.namespace;e&&e!==c.eo&&this.value.$dispatch("prefs/set",{key:n.Ri,value:e},{root:!0})}await this.actuallySave(t),this.$store.getters["type-map/isSpoofed"](this.value.type)&&await this.$store.dispatch("cluster/findAll",{type:this.value.type,opt:{force:!0}},{root:!0}),await this.applyHooks(o.Mz,this.value),e&&e(!0),this.done()}catch(r){const s=409===r.status||409===r._status;if(s&&0===a&&this.isEdit){const r=await this.conflict();if(!1===r)return this.save(e,t,a+1);this.errors=r}else this.errors=(0,i.rz)(r);d.error("CreateEditView mixin failed to save: ",r),e&&e(!1)}},async actuallySave(e){if(this.isCreate){e=e||this.schema.linkFor("collection");const t=await this.value.save({url:e});t&&Object.assign(this.value,t)}else await this.value.save()},setErrors(e){this.errors=e}}},p=(0,s.defineComponent)({...h,props:{mode:{type:String,default:r.G5},realMode:{type:String,default:r.G5},as:{type:String,default:r.zD},value:{type:Object,required:!0},initialValue:{type:Object,default:null},liveValue:{type:Object,default:null},doneEvent:{type:Boolean,default:!1},useTabbedHash:{type:Boolean,default:void 0},defaultTab:{type:String,default:void 0}}})},13643:function(e,t,a){var r=a(28811);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("096416cc",r,!0,{sourceMap:!1,shadowMode:!1})},19201:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".overlay[data-v-fac347aa]{align-items:center;background-color:var(--subtle-overlay-bg);display:flex;justify-content:center;position:absolute;bottom:0;top:0;left:0;right:0;text-align:center;z-index:12}.overlay-main-mode[data-v-fac347aa]{top:var(--header-height);z-index:51}.overlay-content-mode[data-v-fac347aa]{left:calc(var(--nav-width));top:var(--header-height)}",""]),t["default"]=o},22880:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".bar[data-v-b4f4e2ae]{width:100%;height:15px;border-radius:7.5px;overflow:hidden;position:relative}.bar .indicator[data-v-b4f4e2ae]{height:100%}.bar .slice[data-v-b4f4e2ae]{position:absolute;top:0;bottom:0;width:1px;background-color:var(--body-bg)}",""]),t["default"]=o},25403:function(e,t,a){"use strict";a.d(t,{A:function(){return se}});var r=a(9274);const s={key:0,class:"tab-caption"},n={class:"mt-20"};function i(e,t,a,i,o,l){const c=(0,r.resolveComponent)("Conditions"),u=(0,r.resolveComponent)("Tab"),d=(0,r.resolveComponent)("PaginatedResourceTable"),h=(0,r.resolveComponent)("RelatedResources"),p=(0,r.resolveComponent)("Tabbed"),m=(0,r.resolveDirective)("clean-html"),g=(0,r.resolveDirective)("t");return(0,r.openBlock)(),(0,r.createBlock)(p,(0,r.mergeProps)({class:["resource-tabs",{[a.mode]:!0}]},e.$attrs,{"default-tab":a.defaultTab,resource:a.value,"use-hash":a.useHash}),{default:(0,r.withCtx)(()=>[(0,r.renderSlot)(e.$slots,"default",{},void 0,!0),o.showConditions?((0,r.openBlock)(),(0,r.createBlock)(u,{key:0,"label-key":"resourceTabs.conditions.tab",name:"conditions",weight:-1,"display-alert-icon":l.conditionsHaveIssues},{default:(0,r.withCtx)(()=>[(0,r.createVNode)(c,{value:a.value},null,8,["value"])]),_:1},8,["display-alert-icon"])):(0,r.createCommentVNode)("",!0),l.showEvents?((0,r.openBlock)(),(0,r.createBlock)(u,{key:1,label:l.isNamespace?e.t("resourceTabs.events.namespaceTab"):e.t("resourceTabs.events.tab"),name:"events",weight:-2},{default:(0,r.withCtx)(()=>[l.isNamespace?(0,r.withDirectives)(((0,r.openBlock)(),(0,r.createElementBlock)("div",s,null,512)),[[m,e.t("resourceTabs.events.namespaceCaption",{namespace:a.value.metadata.name},!0)]]):(0,r.createCommentVNode)("",!0),(0,r.createVNode)(d,{schema:o.eventSchema,"local-filter":l.filterEventsLocal,"api-filter":l.filterEventsApi,"use-query-params-for-simple-filtering":!1,headers:l.eventHeaders,paginationHeaders:o.paginationHeaders,namespaced:!1},null,8,["schema","local-filter","api-filter","headers","paginationHeaders"])]),_:1},8,["label"])):(0,r.createCommentVNode)("",!0),l.showRelated?((0,r.openBlock)(),(0,r.createBlock)(u,{key:2,name:"related","label-key":"resourceTabs.related.tab",weight:-3},{default:(0,r.withCtx)(()=>[(0,r.withDirectives)((0,r.createElementVNode)("h3",null,null,512),[[g,"resourceTabs.related.from"]]),(0,r.createVNode)(h,{"ignore-types":[a.value.type],value:a.value,direction:"from"},null,8,["ignore-types","value"]),(0,r.withDirectives)((0,r.createElementVNode)("h3",n,null,512),[[g,"resourceTabs.related.to"]]),(0,r.createVNode)(h,{"ignore-types":[a.value.type],value:a.value,direction:"to"},null,8,["ignore-types","value"])]),_:1})):(0,r.createCommentVNode)("",!0)]),_:3},16,["class","default-tab","resource","use-hash"])}var o=a(86879),l=a(42411),c=a(2517);function u(e,t,a,s,n,i){const o=(0,r.resolveComponent)("SortableTable");return(0,r.openBlock)(),(0,r.createBlock)(o,{headers:i.headers,rows:i.rows,"key-field":"condition","default-sort-by":"condition","table-actions":!1,"row-actions":!1,search:!1},{"cell:condition":(0,r.withCtx)(({row:e})=>[(0,r.createElementVNode)("span",{class:(0,r.normalizeClass)({"text-error":e.error})},(0,r.toDisplayString)(e.condition),3)]),"cell:status":(0,r.withCtx)(({row:e})=>[(0,r.createElementVNode)("span",{class:(0,r.normalizeClass)({"text-error":e.error})},(0,r.toDisplayString)(e.status),3)]),_:1},8,["headers","rows"])}var d=a(20232),h={components:{SortableTable:d.A},props:{value:{type:Object,default:()=>({})}},computed:{headers(){return[{name:"condition",labelKey:"tableHeaders.condition",value:"condition",width:150,sort:"condition",dashIfEmpty:!0},{name:"status",labelKey:"tableHeaders.status",value:"status",width:75,sort:"status",dashIfEmpty:!0},{name:"time",labelKey:"tableHeaders.updated",value:"time",sort:"time",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125,dashIfEmpty:!0},{name:"message",labelKey:"tableHeaders.message",value:"message",sort:["message"],dashIfEmpty:!0}]},rows(){return(this.value.status?.conditions||[]).map(e=>{let t=e.message||"";return e.reason&&(t=`[${e.reason}] ${t}`.trim()),{condition:e.type||"Unknown",status:e.status||"Unknown",error:e.error,time:e.lastProbeTime||e.lastUpdateTime||e.lastTransitionTime,message:t}})}}},p=a(47433);const m=(0,p.A)(h,[["render",u]]);var g=m,f=a(35664);function v(e,t,a,s,n,i){const o=(0,r.resolveComponent)("ResourceTable");return(0,r.openBlock)(),(0,r.createElementBlock)("div",null,[(0,r.createVNode)(o,(0,r.mergeProps)({ref:"table"},e.$attrs,{schema:e.schema,rows:e.rows,"alt-loading":e.canPaginate&&!e.isFirstLoad,loading:e.loading,"group-by":e.groupBy,"group-sort":e.groupSort,groupable:e.groupable,groupTooltip:e.groupTooltip,groupOptions:e.groupOptions,"override-in-store":e.overrideInStore,headers:e.safeHeaders,namespaced:e.namespaced,"external-pagination-enabled":e.canPaginate,"external-pagination-result":e.paginationResult,onPaginationChanged:e.paginationChanged}),(0,r.createSlots)({_:2},[(0,r.renderList)(e.$slots,(t,a)=>({name:a,fn:(0,r.withCtx)(t=>[(0,r.renderSlot)(e.$slots,a,(0,r.normalizeProps)((0,r.guardReactiveProps)(t)))])}))]),1040,["schema","rows","alt-loading","loading","group-by","group-sort","groupable","groupTooltip","groupOptions","override-in-store","headers","namespaced","external-pagination-enabled","external-pagination-result","onPaginationChanged"])])}var y=a(65359),b=a(9262),w=a(18110);const S="ResourceList";var k=a(34765);class ${isApplicable(e){return Array.isArray(e.namespaced)}isEnabled(e){var t;const a=e["currentProduct"];if("cluster"!==(null===a||void 0===a?void 0:a.inStore))return!1;if(null===a||void 0===a?void 0:a.showWorkspaceSwitcher)return!1;const r=(0,k.fD)(e);return!!(null===(t=r.forceNsFilterV2)||void 0===t?void 0:t.enabled)}checkAndCreateParam(e){return this.isApplicable(e)?this.createParam(e.namespaced):""}createParam(e){if(!e||!e.length)return"";const t=e.reduce((e,t)=>{const a=t.replace(w.os,"").replace(w.tA,"");return a.startsWith("-")?e.exclude.push(t.substring(1,t.length)):e.include.push(a),e},{include:[],exclude:[]});let a="";return t.include.length&&(a=`${$.param}=${t.include.join(",")}`),t.exclude.length&&(a=`${$.param}!=${t.exclude.join(",")}`),a}}$.param="projectsornamespaces";var x=new $,R={data(){return{forceUpdateLiveAndDelayed:0}},computed:{...(0,y.L8)(["currentProduct","currentCluster","namespaceFilters"]),namespaceFilterRequired(){return this.__namespaceRequired&&!this.__validFilter},namespaceFilter(){return this.__namespaceRequired?this.__validFilter:""},__validFilter(){const e=this.namespaceFilters.length&&this.namespaceFilters.every(e=>e.startsWith(w.EF)||e.startsWith(w.xs));return e?this.namespaceFilters:null},__namespaceRequired(){return!!x.isEnabled(this.$store.getters)&&this.__areResourcesNamespaced},__areResourcesNamespaced(){return"cluster"===this.currentProduct.inStore&&(this.loadResources||[]).every(e=>{const t=this.$store.getters["cluster/schemaFor"](e);return t?.attributes?.namespaced})}},watch:{async namespaceFilter(e){e&&(this.$options.name!==S&&this.$fetch&&await this.$fetch(),this.forceUpdateLiveAndDelayed=(new Date).getTime())}}},C=a(59136),P=a(15092),N=a(12784),B=a.n(N),E=a(50025),_=a(82637),T=a(88343),A={props:{namespaced:{type:Boolean,default:null},context:{type:String,default:null}},data(){return{forceUpdateLiveAndDelayed:0,pPagination:null,debouncedSetPagination:B()(this.setPagination,50),requestFilters:{filters:[],projectsOrNamespaces:[]},paginationFromList:null,isPaginationManualRefreshEnabled:P.A.isListManualRefreshEnabled({rootGetters:this.$store.getters})}},methods:{setPagination(e){e&&(this.pPagination=e)},paginationChanged(e){if(!e)return;this.paginationFromList=e;const{page:t,perPage:a,filter:r,sort:s,descending:n}=e,i=r.searchQuery?r.searchFields.map(e=>new E.Js({field:e,value:r.searchQuery,exact:!1})):[],o=new E.gR({page:t,pageSize:a,sort:s?.map(e=>({field:e,asc:!n})),projectsOrNamespaces:this.requestFilters.projectsOrNamespaces,filters:[new E.eY({fields:i}),...this.requestFilters.filters]});this.debouncedSetPagination(o)},paginationEqual(e,t){return!!e.page&&!!P.A.paginationEqual(e,t)},calcCanPaginate(){if(!this.resource)return!1;const e={id:this.resource.id||this.resource,context:this.context};return this.$store.getters[`${this.overrideInStore||this.inStore}/paginationEnabled`]?.(e)}},computed:{...(0,y.L8)(["currentProduct","isAllNamespaces"]),namespaceFilters(){return this.$store.getters["namespaceFilters"]},paginationNsFilterRequired(){return this.canPaginate&&!this.__validPaginationNsFilter},__validPaginationNsFilter(){return P.A.validateNsProjectFilters(this.namespaceFilters)},isResourceList(){return!!this.hasListComponent},pagination(){if(!this.isResourceList)return this.canPaginate?this.pPagination:""},canPaginate(){if(!this.isResourceList)return this.calcCanPaginate()},paginationResult(){if(!this.isResourceList&&this.canPaginate)return this.havePaginated?.result},havePaginated(){if(!this.isResourceList)return this.$store.getters[`${this.overrideInStore||this.inStore}/havePage`](this.resource)},productHidesSystemNamespaces(){return this.currentProduct?.hideSystemResources},showDynamicRancherNamespaces(){return this.$store.getters["prefs/get"](C.Pz)},isNamespaced(){return null!==this.namespaced?!!this.namespaced:this.schema?.attributes?.namespaced}},watch:{rows(e){this.canPaginate&&this.pagination&&!this.isResourceList&&this.pagination.page>1&&0===e.length&&this.setPagination({...this.pagination,page:this.pagination.page-1})},namespaceFilters:{immediate:!0,async handler(e,t){if(!this.canPaginate||!this.isNamespaced)return;if(this.isResourceList)return;const a=!e||0===e.length||e[0]===w.tj,r=!t||0===t.length||t[0]===w.tj;if(a&&r){const e=this.isAllNamespaces&&(!this.showDynamicRancherNamespaces||this.productHidesSystemNamespaces);if(!e)return}if(1===e.length&&[w.x8,w.TD].includes(e[0]))return;const{projectsOrNamespaces:s,filters:n}=_.A.createParamsFromNsFilter({allNamespaces:this.$store.getters[`${this.currentProduct?.inStore}/all`](f.CU),selection:e,isAllNamespaces:this.isAllNamespaces,isLocalCluster:this.$store.getters["currentCluster"].isLocal,showReservedRancherNamespaces:this.showDynamicRancherNamespaces,productHidesSystemNamespaces:this.productHidesSystemNamespaces});this.requestFilters.filters=n,this.requestFilters.projectsOrNamespaces=s}},"requestFilters.filters"(){this.paginationChanged(this.paginationFromList)},"requestFilters.projectsOrNamespaces"(){this.paginationChanged(this.paginationFromList)},async pagination(e,t){this.canPaginate&&(this.isResourceList||e&&this.$options.name!==S&&this.$fetch&&!this.paginationEqual(e,t)&&(await this.$fetch(!1),this.forceUpdateLiveAndDelayed=(new Date).getTime()))},async paginationResult(e,t){this.fetchPageSecondaryResources&&e&&e.timestamp!==t?.timestamp&&await this.fetchPageSecondaryResources({canPaginate:this.canPaginate,force:!1,page:this.rows,pagResult:this.paginationResult})}},async beforeUnmount(){if(this.havePaginated){const e={type:this.resource,mode:T.g.RESOURCE_CHANGES};await this.$store.dispatch(`${this.overrideInStore||this.inStore}/forgetType`,this.resource,t=>t.type===e.type&&t.mode===e.type.mode)}}};class F{constructor(e){this.setting=e}isEnabled(e,t){return!e&&t[this.setting].enabled}}var V={incrementalLoadingUtils:new F("incrementalLoading"),manualRefreshUtils:new F("manualRefresh")},O=a(4364);const M=4;var I={mixins:[R,A],inheritAttrs:!1,data(){const e=this.$store.getters["management/byId"](f.Mc.SETTING,b.HG.UI_PERFORMANCE);let t={};if(e&&e.value)try{t=JSON.parse(e.value)}catch(n){O.warn("ui-performance setting contains invalid data")}else t=b.$8;const a={...this.$route.params},r=a.resource||this.schema?.id,s=this.$store.getters["currentStore"](r);return{inStore:s,perfConfig:t,init:!1,multipleResources:[],loadResources:[r],hasManualRefresh:!1,watch:!0,isTooManyItemsToAutoUpdate:!1,force:!1,incremental:!1,fetchedResourceType:[],paginating:null,isFirstLoad:!0}},beforeUnmount(){this.init&&(this.$store.dispatch("resource-fetch/clearData"),this.fetchedResourceType.forEach(e=>{this.$store.dispatch(`${e.currStore}/incrementLoadCounter`,e.type)}))},props:{localFilter:{type:Function,default:null},apiFilter:{type:Function,default:null}},computed:{...(0,y.L8)({refreshFlag:"resource-fetch/refreshFlag"}),rows(){const e=this.fetchedResourceType.find(e=>e.type===this.resource);if(e){const t=this.$store.getters[`${e.currStore}/all`](this.resource);if(!this.canPaginate)return this.localFilter?this.localFilter(t):t;if(this.havePaginated)return t}return[]},loading(){return this.canPaginate?null===this.paginating||this.paginating:!this.rows.length&&this.$fetchState.pending}},watch:{async refreshFlag(e){this.init&&e&&(await this.$fetch(),this.clearSelection&&this.clearSelection(),this.canPaginate&&this.fetchPageSecondaryResources&&this.fetchPageSecondaryResources({canPaginate:this.canPaginate,force:!0,page:this.rows,pagResult:this.paginationResult}))},loading(e,t){t&&!e&&(this.isFirstLoad=!1)}},methods:{$initializeFetchData(e,t=[],a){if(!this.init){const r=a||this.$store.getters["currentStore"]();this.__gatherResourceFetchData(e,t,r),this.watch||(this.force=!0),this.isTooManyItemsToAutoUpdate&&(this.hasManualRefresh=!0)}},$fetchType(e,t=[],a){const r=a||this.$store.getters["currentStore"]();this.$initializeFetchData(e,t,r),this.fetchedResourceType.find(t=>t.type===e)||this.fetchedResourceType.push({type:e,currStore:r});const s=this.$store.getters[`${r}/schemaFor`](e);if(this.canPaginate){if(!this.pagination)return;const t={hasManualRefresh:this.hasManualRefresh,pagination:{...this.pagination},force:null!==this.paginating};this.apiFilter&&(t.paginating=this.apiFilter(t.pagination)),this["paginating"]=!0;const a=this;return this.$store.dispatch(`${r}/findPage`,{type:e,opt:t}).finally(()=>a["paginating"]=!1)}let n=null;if(this.incremental){const t=this.__getCountForResources([e],this.namespaceFilter,r);n={quickLoadCount:100,resourcesPerIncrement:Math.ceil(t/M),increments:M,pageByNumber:this.$store.getters[`${this.inStore}/paginationEnabled`]?.()}}const i={incremental:n,watch:this.watch,force:this.force,hasManualRefresh:this.hasManualRefresh};return s?.attributes?.namespaced&&(i.namespaced=this.namespaceFilter),this.$store.dispatch(`${r}/findAll`,{type:e,opt:i})},__getCountForResources(e,t,a){const r=a||this.$store.getters["currentStore"]();return e.reduce((e,a)=>e+this.__getCountForResource(a,t,r),0)},__getCountForResource(e,t,a){const r=a||this.$store.getters["currentStore"](),s=this.$store.getters[`${r}/all`](f.i2)[0]?.counts[`${e}`],n=t&&s?.namespaces?s?.namespaces[t]?.count:s?.summary?.count;return n||0},__gatherResourceFetchData(e,t,a){this.init=!0;const r=V.manualRefreshUtils.isEnabled(this.calcCanPaginate(),this.perfConfig),s=parseInt(this.perfConfig?.manualRefresh?.threshold||"0",10),n=V.incrementalLoadingUtils.isEnabled(this.calcCanPaginate(),this.perfConfig),i=parseInt(this.perfConfig?.incrementalLoading?.threshold||"0",10);this.multipleResources=t;let o=0,l=!0,c=!1,u=!1;const d=this.multipleResources.length?this.multipleResources:[e];o=this.__getCountForResources(d,this.namespaceFilter,a),r&&o>=s?(l=!1,c=!0):this.canPaginate&&this.isPaginationManualRefreshEnabled&&(c=!0),u=n&&i>0&&o>=i,this.$store.dispatch("resource-fetch/updateIsTooManyItems",c),this.watch=l,this.isTooManyItemsToAutoUpdate=c,this.incremental=u}}},D=a(55008),L=(0,r.defineComponent)({name:"PaginatedResourceTable",components:{ResourceTable:D.A},mixins:[I],props:{schema:{type:Object,required:!0},headers:{type:Array,default:null},paginationHeaders:{type:Array,default:null},groupTooltip:{type:String,default:"resourceTable.groupBy.namespace"},groupBy:{type:String,default:null},groupSort:{type:String,default:null},groupOptions:{type:Array,default:null},groupable:{type:Boolean,default:null},namespaced:{type:Boolean,default:null},fetchSecondaryResources:{type:Function,default:null},overrideInStore:{type:String,default:void 0},fetchPageSecondaryResources:{type:Function,default:null}},data(){return{resource:this.schema.id}},async fetch(){this.fetchSecondaryResources&&await this.fetchSecondaryResources({canPaginate:this.canPaginate}),await this.$fetchType(this.resource,[],this.overrideInStore||this.inStore)},computed:{safeHeaders(){const e=this.canPaginate?this.paginationHeaders:this.headers,t=this.$store;return e||t.getters["type-map/headersFor"](this.schema,this.canPaginate)}},methods:{clearSelection(){const e=this.$refs.table;e.clearSelection()}}});const j=(0,p.A)(L,[["render",v]]);var U=j,q=a(14220);function H(e,t,a,s,n,i){const o=(0,r.resolveComponent)("BadgeState"),l=(0,r.resolveComponent)("ResourceTable");return(0,r.openBlock)(),(0,r.createBlock)(l,{schema:null,rows:i.rows,headers:i.headers,search:!1,"table-actions":!1,namespaced:!0,"mangle-action-resources":i.getRealResources,"paging-label":"sortableTable.paging.generic",groupable:!1},{"cell:state":(0,r.withCtx)(({row:e})=>[(0,r.createVNode)(o,{value:e},null,8,["value"])]),_:1},8,["rows","headers","mangle-action-resources"])}var z=a(67943),W=a(68774),G=a(74302),Q=a(27278),Y=a(55937),K={components:{ResourceTable:D.A,BadgeState:Y.j},props:{value:{type:Object,required:!0},rel:{type:String,default:null},direction:{type:String,default:"to"},ignoreTypes:{type:Array,default:()=>[]}},data(){return{loadedResources:1}},computed:{filteredRelationships(){let e=this.value?.metadata?.relationships||[];return e=e.filter(e=>{const t=e[`${this.direction}Type`];return!(!t||this.ignoreTypes.includes(t))&&(!this.rel||e.rel===this.rel)}),e},rows(){if(this.loadedResources<1)return;const e=this.$store.getters["clusterId"],t=this.$store.getters["currentStore"](),a=[];for(const r of this.filteredRelationships){const s=r[`${this.direction}Type`],n=r.state||this.$store.getters[`${t}/byId`](s,r[`${this.direction}Id`])?.state||z.jv.MISSING,i=(0,z.uU)(n,r.error,r.transitioning),o=this.$store.getters[`${t}/schemaFor`](s);let l=r[`${this.direction}Id`];if(!l)continue;let c=null;const u=l.indexOf("/"),d=`${s}/${c}/${l}`;u>0&&(c=l.substr(0,u),l=l.substr(u+1));const h={name:`c-cluster-product-resource${c?"-namespace":""}-id`,params:{product:Q.o,cluster:"management"===t?"local":e,resource:s,namespace:c,id:l}};h.params.namespace||delete h.params.namespace,a.push({type:s,id:r[`${this.direction}Id`],state:n,metadata:{namespace:c,name:l},_key:d,name:l,namespace:c,nameDisplay:l,nameSort:(0,G.RY)(l).toLowerCase(),stateColor:i,detailLocation:h,typeDisplay:this.$store.getters["type-map/labelFor"](o),stateDisplay:(0,z.ch)(n),stateBackground:i.replace("text-","bg-"),groupByLabel:c})}return a},headers(){return[W.c4,W.ZE,W.o_,W.CU]}},methods:{async getRealResources(e){const t=this.$store.getters["currentStore"](),a=await Promise.allSettled(e.map(e=>this.$store.dispatch(`${t}/find`,{type:e.type,id:e.id}))),r=[];for(let s=0;s<a.length;s++)"fulfilled"===a[s].status&&r.push(a[s].value);return this.loadedResources++,r}}};const Z=(0,p.A)(K,[["render",H]]);var J=Z,X=a(57699),ee=a(46392),te=a(44544),ae={name:"ResourceTabs",components:{Tabbed:o.A,Tab:l.A,Conditions:g,PaginatedResourceTable:U,RelatedResources:J},mixins:[c.A],props:{value:{type:Object,default:()=>({})},mode:{type:String,default:q.nW},defaultTab:{type:String,default:null},needConditions:{type:Boolean,default:!0},needEvents:{type:Boolean,default:!0},needRelated:{type:Boolean,default:!0},extensionParams:{type:Object,default:null},useHash:{type:Boolean,default:!0}},setup(e){e.mode===q.nW&&(0,te.wi)()},data(){const e=this.$store.getters["currentStore"](f.ll),t=this.$store.getters[`${e}/schemaFor`](f.ll),a=t?[X.ke,X.qI,W.rh,(0,ee.UQ)("Subobject",t,this.$store.getters,!0),(0,ee.UQ)("Source",t,this.$store.getters,!0),W.w5,X.IZ,(0,ee.UQ)("Count",t,this.$store.getters,!0),X.l3]:[];return{eventSchema:t,EVENT:f.ll,inStore:e,showConditions:!1,paginationHeaders:a}},beforeUnmount(){this.$store.dispatch("cluster/forgetType",f.ll)},fetch(){this.setShowConditions()},computed:{isNamespace(){return this.value?.type===f.CU},showEvents(){return this.isView&&this.needEvents&&this.eventSchema},showRelated(){return this.isView&&this.needRelated},eventHeaders(){return[{name:"type",label:this.t("tableHeaders.type"),value:"eventType",sort:"eventType"},{name:"reason",label:this.t("tableHeaders.reason"),value:"reason",sort:"reason"},{name:"date",label:this.t("tableHeaders.updated"),value:"date",sort:"date:desc",formatter:"LiveDate",formatterOpts:{addSuffix:!0},width:125},{name:"message",label:this.t("tableHeaders.message"),value:"message",sort:"message"}]},conditionsHaveIssues(){return!!this.showConditions&&this.value.status?.conditions?.filter(e=>!(0,z.rv)(e)).some(e=>e.error)},children(){return this.$slots?.default?.()||[]}},methods:{async setShowConditions(){this.isView&&this.needConditions&&this.value?.type&&this.schema?.fetchResourceFields&&(await this.schema.fetchResourceFields(),this.showConditions=this.$store.getters[`${this.inStore}/pathExistsInSchema`](this.value.type,"status.conditions"))},filterEventsLocal(e){return e.filter(e=>this.isNamespace?e.metadata?.namespace===this.value?.metadata?.name:e.involvedObject?.uid===this.value?.metadata?.uid)},filterEventsApi(e){e.filters||(e.filters=[]);const t=this.isNamespace?"metadata.namespace":"involvedObject.uid",a=this.isNamespace?this.value.metadata.name:this.value.metadata.uid,r=e.filters.find(e=>e.fields.some(e=>e.field===t)),s=E.eY.createSingleField({field:t,exact:!0,value:a,equals:!0});return r?Object.assign(r,s):e.filters.push(s),e}}};a(45244);const re=(0,p.A)(ae,[["render",i],["__scopeId","data-v-4f2c6329"]]);var se=re},28811:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".sortable-table TD .badge-state{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;word-wrap:break-word;display:inline-block;max-width:100%;position:relative;max-width:110px;font-size:.85em;vertical-align:middle}",""]),t["default"]=o},29535:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".grafana-graph[data-v-2ba52de3]{position:relative;min-height:100%;min-width:100%}.grafana-graph[data-v-2ba52de3]  .content{position:relative;display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%;padding:0}.grafana-graph[data-v-2ba52de3]  .overlay{position:static;background-color:initial}.grafana-graph iframe[data-v-2ba52de3]{position:absolute;left:0;right:0;top:20px;bottom:0;width:100%;height:100%;overflow:hidden}.grafana-graph iframe.loading[data-v-2ba52de3]{visibility:hidden}",""]),t["default"]=o},33814:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".consumption-gauge .numbers{display:flex;flex-direction:row;justify-content:space-between}.consumption-gauge .numbers-stats{display:flex;flex-direction:row;align-items:center;gap:10px;align-self:baseline}.consumption-gauge .numbers .percentage{font-weight:700}.consumption-gauge .numbers .percentage i{margin-right:10px}",""]),t["default"]=o},35493:function(e,t,a){var r=a(60037);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("5bc3db34",r,!0,{sourceMap:!1,shadowMode:!1})},36261:function(e,t,a){var r=a(99365);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("30c04df4",r,!0,{sourceMap:!1,shadowMode:!1})},45244:function(e,t,a){var r=a(49564);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("604c6d5e",r,!0,{sourceMap:!1,shadowMode:!1})},46877:function(e,t,a){"use strict";a.d(t,{A:function(){return N}});var r=a(9274);const s={class:"consumption-gauge"},n={key:0},i={class:"numbers"},o={key:0},l={key:1},c={class:"numbers-stats"},u={class:"percentage"},d={class:"mt-10"};function h(e,t,a,h,p,m){const g=(0,r.resolveComponent)("PercentageBar");return(0,r.openBlock)(),(0,r.createElementBlock)("div",s,[a.resourceName&&!a.usedAsResourceName?((0,r.openBlock)(),(0,r.createElementBlock)("h3",n,(0,r.toDisplayString)(a.resourceName),1)):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("div",i,[(0,r.renderSlot)(e.$slots,"title",{amountTemplateValues:m.amountTemplateValues,formattedPercentage:m.formattedPercentage},()=>[a.usedAsResourceName?((0,r.openBlock)(),(0,r.createElementBlock)("h4",o,(0,r.toDisplayString)(a.resourceName),1)):((0,r.openBlock)(),(0,r.createElementBlock)("span",l,(0,r.toDisplayString)(e.t("node.detail.glance.consumptionGauge.used")),1)),(0,r.createElementVNode)("span",c,[(0,r.createTextVNode)((0,r.toDisplayString)(e.t("node.detail.glance.consumptionGauge.amount",m.amountTemplateValues))+" ",1),(0,r.createElementVNode)("span",u,[t[0]||(t[0]=(0,r.createElementVNode)("i",null,"/Â ",-1)),(0,r.createTextVNode)((0,r.toDisplayString)(m.formattedPercentage),1)])])])]),(0,r.createElementVNode)("div",d,[(0,r.createVNode)(g,{modelValue:m.percentageBarValue,"color-stops":a.colorStops},null,8,["modelValue","color-stops"])])])}const p={class:"percentage-bar"},m={key:0,class:"ml-5 percentage-value"};function g(e,t,a,s,n,i){const o=(0,r.resolveComponent)("Bar");return(0,r.openBlock)(),(0,r.createElementBlock)("span",p,[(0,r.createVNode)(o,{percentage:a.modelValue,"primary-color":i.primaryColor,slices:a.slices},null,8,["percentage","primary-color","slices"]),a.showPercentage?((0,r.openBlock)(),(0,r.createElementBlock)("span",m,(0,r.toDisplayString)(i.formattedPercentage),1)):(0,r.createCommentVNode)("",!0)])}function f(e,t,a,s,n,i){return(0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"bar",style:(0,r.normalizeStyle)(i.barStyle)},[(0,r.createElementVNode)("div",{class:"indicator",style:(0,r.normalizeStyle)(i.indicatorStyle)},null,4),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(i.sliceStyles,(e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{key:t,class:"slice",style:(0,r.normalizeStyle)(e)},null,4))),128))],4)}var v={props:{percentage:{type:Number,required:!0},primaryColor:{type:String,default:"--primary"},secondaryColor:{type:String,default:"--border"},slices:{type:Array,default:()=>[]}},computed:{indicatorStyle(){return{width:`${this.percentage}%`,backgroundColor:`var(${this.primaryColor})`}},barStyle(){return{backgroundColor:`var(${this.secondaryColor})`}},sliceStyles(){return this.slices.map(e=>({left:`${e}%`,visibility:e<this.percentage?"visible":"hidden"}))}}},y=(a(54752),a(47433));const b=(0,y.A)(v,[["render",f],["__scopeId","data-v-b4f4e2ae"]]);var w=b,S=a(92043);const k={LESS:"LESS",MORE:"MORE"};var $={components:{Bar:w},props:{modelValue:{type:Number,required:!0,validator(e){return e>=0}},preferredDirection:{type:String,default:k.LESS},showPercentage:{type:Boolean,default:!1},colorStops:{type:Object,default:null},slices:{type:Array,default:()=>[]}},computed:{primaryColor(){const e=this.preferredDirection===k.LESS;if(this.colorStops){const t=Object.keys(this.colorStops).sort();if(e){let e=t.length-1;while(this.modelValue<t[e])e--;return this.colorStops[t[e]]}{let e=0;while(this.modelValue>t[e])e++;return this.colorStops[t[e]]}}const t=e?80:20,a=e?this.modelValue:t,r=e?t:this.modelValue;return a<=r?"--primary":"--error"},formattedPercentage(){return(0,S.l9)(this.modelValue)}}};a(70738);const x=(0,y.A)($,[["render",g],["__scopeId","data-v-4ade54a6"]]);var R=x,C={components:{PercentageBar:R},props:{resourceName:{type:String,default:""},capacity:{type:Number,required:!0},used:{type:Number,required:!0},units:{type:String,default:""},numberFormatter:{type:Function,default:e=>Number.isInteger(e)?e:e.toFixed(2)},colorStops:{type:Object,default:null},usedAsResourceName:{type:Boolean,defaut:!1}},computed:{displayUnits(){return this.units?` ${this.units}`:""},percentageBarValue(){return this.used&&this.capacity?100*this.used/this.capacity:0},amountTemplateValues(){return{used:this.numberFormatter(this.used||0),total:this.numberFormatter(this.capacity||0),unit:this.displayUnits}},formattedPercentage(){return(0,S.l9)(this.percentageBarValue)}}};a(95606);const P=(0,y.A)(C,[["render",h]]);var N=P},49564:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".resource-tabs.view[data-v-4f2c6329]  .tabs.horizontal{border:none}.resource-tabs.view[data-v-4f2c6329]  .tabs.horizontal+.tab-container{border:none;border-top:1px solid var(--border);padding:0;padding-top:24px}.tab-caption[data-v-4f2c6329]{align-items:center;font-size:16px;margin-bottom:24px}.tab-caption .namespace-name[data-v-4f2c6329]{display:inline;font-weight:700;margin-right:0 4px;white-space:nowrap}",""]),t["default"]=o},52799:function(e,t,a){"use strict";a.d(t,{A:function(){return u}});var r=a(4364);function s(e,t,a){return(t=n(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e){var t=i(e,"string");return"symbol"==typeof t?t:t+""}function i(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}class o{constructor(e,t,a=Number.POSITIVE_INFINITY){s(this,"fn",void 0),s(this,"pollRateMs",void 0),s(this,"maxRetries",void 0),s(this,"intervalId",void 0),s(this,"tryCount",0),this.fn=e||(()=>{}),this.pollRateMs=t,this.maxRetries=a}start(){this.stop(),this._intervalMethod(),this.intervalId=setInterval(()=>this._intervalMethod(),this.pollRateMs)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)}async _intervalMethod(){try{await this.fn(),this.tryCount=0}catch(e){r.error("Error encountered while polling",e),++this.tryCount>=this.maxRetries&&this.stop()}}}const l=3e4,c=2;var u={data(){return{metricPoller:null}},mounted(){this.metricPoller=new o(this.loadMetrics,l,c),this.metricPoller.start()},beforeUnmount(){this.metricPoller.stop()}}},54752:function(e,t,a){var r=a(22880);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("bcd5ae90",r,!0,{sourceMap:!1,shadowMode:!1})},55937:function(e,t,a){"use strict";a.d(t,{j:function(){return c}});var r=a(9274);const s={class:"msg"};function n(e,t,a,n,i,o){return(0,r.openBlock)(),(0,r.createElementBlock)("span",{class:(0,r.normalizeClass)(["badge-state",e.bg])},[e.icon?((0,r.openBlock)(),(0,r.createElementBlock)("i",{key:0,class:(0,r.normalizeClass)(["icon",{[e.icon]:!0,"mr-5":!!e.msg}])},null,2)):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("span",s,(0,r.toDisplayString)(e.msg),1),(0,r.renderSlot)(e.$slots,"content-right",{},void 0,!0)],2)}var i=(0,r.defineComponent)({props:{value:{type:Object,default:null},color:{type:String,default:null},icon:{type:String,default:null},label:{type:String,default:null}},computed:{bg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateBackground)||this.color},msg(){var e;return(null===(e=this.value)||void 0===e?void 0:e.stateDisplay)||this.label}}}),o=(a(36261),a(13643),a(47433));const l=(0,o.A)(i,[["render",n],["__scopeId","data-v-544b3117"]]);var c=l},56530:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".percentage-bar[data-v-4ade54a6]{display:flex;flex-direction:row}.percentage-bar .percentage-value[data-v-4ade54a6]{word-break:keep-all}",""]),t["default"]=o},59065:function(e,t,a){"use strict";a.d(t,{A:function(){return u}});var r=a(9274);function s(e,t,a,s,n,i){const o=(0,r.resolveComponent)("BadgeState");return(0,r.openBlock)(),(0,r.createBlock)(o,{label:a.message,color:i.color,icon:i.icon},null,8,["label","color","icon"])}var n=a(55937);const i={success:{color:"bg-success",icon:"icon-checkmark"},warning:{color:"bg-warning",icon:"icon-warning"},info:{color:"bg-info",icon:"icon-info"},error:{color:"bg-error",icon:"icon-error"}};var o={components:{BadgeState:n.j},props:{status:{type:String,validator(e){return Object.keys(i).includes(e)},required:!0},message:{type:String,required:!0}},computed:{color(){return i[this.status].color},icon(){return i[this.status].icon}}},l=a(47433);const c=(0,l.A)(o,[["render",s]]);var u=c},60037:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".dashboard-metrics[data-v-5cdbd67f]  .external-link{position:absolute;left:200px;top:-45px}.dashboard-metrics[data-v-5cdbd67f]  .frame{top:0}.dashboard-metrics.external-link-pull-left[data-v-5cdbd67f]  .external-link{position:absolute;left:10px;top:-47px}",""]),t["default"]=o},60513:function(e,t,a){var r=a(19201);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("9eb1273a",r,!0,{sourceMap:!1,shadowMode:!1})},70738:function(e,t,a){var r=a(56530);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("b37b1fae",r,!0,{sourceMap:!1,shadowMode:!1})},76142:function(e,t,a){var r=a(80097);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("0fc0e1d4",r,!0,{sourceMap:!1,shadowMode:!1})},80097:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".graph-options[data-v-f155ff46],.graph-options .range-refresh[data-v-f155ff46]{display:flex;flex-direction:row;justify-content:flex-end}.graph-options[data-v-f155ff46]{justify-content:space-between;align-items:center}.graph-options .labeled-select[data-v-f155ff46]{width:100px;margin-left:10px}",""]),t["default"]=o},83030:function(e,t,a){"use strict";a.d(t,{A:function(){return V}});var r=a(9274);const s={class:"graph-options mb-10"},n={class:"info"};function i(e,t,a,i,o,l){const c=(0,r.resolveComponent)("DashboardOptions"),u=(0,r.resolveComponent)("GrafanaDashboard");return(0,r.openBlock)(),(0,r.createElementBlock)("div",{class:(0,r.normalizeClass)(["dashboard-metrics",!a.hasSummaryAndDetail&&"external-link-pull-left"])},[(0,r.createElementVNode)("div",s,[(0,r.createVNode)(c,{value:o.graphOptions,"onUpdate:value":t[0]||(t[0]=e=>o.graphOptions=e),"has-summary-and-detail":a.hasSummaryAndDetail},null,8,["value","has-summary-and-detail"])]),(0,r.createElementVNode)("div",n,[(0,r.renderSlot)(e.$slots,"default",{},void 0,!0)]),(0,r.createElementVNode)("div",{class:"graphs",style:(0,r.normalizeStyle)({height:a.graphHeight})},["detail"===o.graphOptions.type?((0,r.openBlock)(),(0,r.createBlock)(u,{key:"'detail'",class:"col span-12 detail","background-color":l.graphBackgroundColor,theme:l.theme,"refresh-rate":o.graphOptions.refreshRate,range:o.graphOptions.range,url:a.detailUrl,vars:a.vars,"modify-prefix":a.modifyPrefix},null,8,["background-color","theme","refresh-rate","range","url","vars","modify-prefix"])):((0,r.openBlock)(),(0,r.createBlock)(u,{key:"'summary'",class:"col span-12 summary","background-color":l.graphBackgroundColor,theme:l.theme,"refresh-rate":o.graphOptions.refreshRate,range:o.graphOptions.range,url:a.summaryUrl,vars:a.vars,"modify-prefix":a.modifyPrefix},null,8,["background-color","theme","refresh-rate","range","url","vars","modify-prefix"]))],4)],2)}const o={class:"graph-options"},l={key:0},c={key:1},u={class:"range-refresh"};function d(e,t,a,s,n,i){const d=(0,r.resolveComponent)("ButtonGroup"),h=(0,r.resolveComponent)("LabeledSelect");return(0,r.openBlock)(),(0,r.createElementBlock)("div",o,[a.hasSummaryAndDetail?((0,r.openBlock)(),(0,r.createElementBlock)("div",l,[(0,r.createVNode)(d,{value:a.value.type,"onUpdate:value":t[0]||(t[0]=e=>a.value.type=e),options:n.detailSummaryOptions},null,8,["value","options"])])):((0,r.openBlock)(),(0,r.createElementBlock)("div",c,t[3]||(t[3]=[(0,r.createElementVNode)("div",null,null,-1)]))),(0,r.createElementVNode)("div",u,[(0,r.createVNode)(h,{value:a.value.range,"onUpdate:value":t[1]||(t[1]=e=>a.value.range=e),options:n.rangeOptions,label:e.t("graphOptions.range")},null,8,["value","options","label"]),(0,r.createVNode)(h,{value:a.value.refreshRate,"onUpdate:value":t[2]||(t[2]=e=>a.value.refreshRate=e),options:n.refreshOptions,label:e.t("graphOptions.refresh")},null,8,["value","options","label"])])])}var h=a(96858),p=a(63679),m={components:{ButtonGroup:h.A,LabeledSelect:p.A},props:{value:{type:Object,required:!0},hasSummaryAndDetail:{type:Boolean,default:!0}},data(){return{range:null,rangeOptions:[{label:this.t("generic.units.time.5m"),value:"5m"},{label:this.t("generic.units.time.1h"),value:"1h"},{label:this.t("generic.units.time.6h"),value:"6h"},{label:this.t("generic.units.time.1d"),value:"1d"},{label:this.t("generic.units.time.7d"),value:"7d"},{label:this.t("generic.units.time.30d"),value:"30d"}],refreshOptions:[{label:this.t("generic.units.time.5s"),value:"5s"},{label:this.t("generic.units.time.10s"),value:"10s"},{label:this.t("generic.units.time.30s"),value:"30s"},{label:this.t("generic.units.time.1m"),value:"1m"},{label:this.t("generic.units.time.5m"),value:"5m"},{label:this.t("generic.units.time.15m"),value:"15m"},{label:this.t("generic.units.time.30m"),value:"30m"},{label:this.t("generic.units.time.1h"),value:"1h"},{label:this.t("generic.units.time.2h"),value:"2h"},{label:this.t("generic.units.time.1d"),value:"1d"}],detailSummaryOptions:[{label:this.t("graphOptions.detail"),value:"detail"},{label:this.t("graphOptions.summary"),value:"summary"}]}}},g=(a(76142),a(47433));const f=(0,g.A)(m,[["render",d],["__scopeId","data-v-f155ff46"]]);var v=f;const y={class:"grafana-graph"},b={class:"text-center"},w=["src"],S={key:1},k={key:2,class:"external-link"},$=["href"];function x(e,t,a,s,n,i){const o=(0,r.resolveComponent)("Banner"),l=(0,r.resolveComponent)("Loading");return(0,r.openBlock)(),(0,r.createElementBlock)("div",y,[n.error?((0,r.openBlock)(),(0,r.createBlock)(o,{key:0,color:"error",style:{"z-index":"1000"}},{default:(0,r.withCtx)(()=>[(0,r.createElementVNode)("div",b,[(0,r.createTextVNode)((0,r.toDisplayString)(e.t("grafanaDashboard.failedToLoad"))+" ",1),(0,r.createElementVNode)("a",{href:"#",onClick:t[0]||(t[0]=(...e)=>i.reload&&i.reload(...e))},(0,r.toDisplayString)(e.t("grafanaDashboard.reload")),1)])]),_:1})):(0,r.createCommentVNode)("",!0),(0,r.withDirectives)((0,r.createElementVNode)("iframe",{ref:"frame",class:(0,r.normalizeClass)({loading:n.loading,frame:!0}),src:i.currentUrl,frameborder:"0",scrolling:"no"},null,10,w),[[r.vShow,!n.error]]),n.loading?((0,r.openBlock)(),(0,r.createElementBlock)("div",S,[(0,r.createVNode)(l)])):(0,r.createCommentVNode)("",!0),n.loading||n.error?(0,r.createCommentVNode)("",!0):((0,r.openBlock)(),(0,r.createElementBlock)("div",k,[(0,r.createElementVNode)("a",{href:i.grafanaUrl,target:"_blank",rel:"noopener nofollow"},[(0,r.createTextVNode)((0,r.toDisplayString)(e.t("grafanaDashboard.grafana"))+" ",1),t[1]||(t[1]=(0,r.createElementVNode)("i",{class:"icon icon-external-link"},null,-1))],8,$)]))])}var R=a(87619),C=a(9980),P=a(97348),N=a(35664),B={components:{Banner:C.l,Loading:R.A},props:{url:{type:String,required:!0},vars:{type:Object,default:()=>({})},range:{type:String,default:null},refreshRate:{type:String,default:null},modifyPrefix:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#1b1c21"},theme:{type:String,default:"dark"}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;if(this.$store.getters[`${e}/canList`](N.W8.APP))try{const t=await this.$store.dispatch(`${e}/find`,{type:N.W8.APP,id:"cattle-monitoring-system/rancher-monitoring"});this.monitoringVersion=t?.currentVersion}catch(t){}},data(){return{loading:!1,error:!1,interval:null,errorTimer:null,monitoringVersion:""}},computed:{currentUrl(){return this.computeUrl()},grafanaUrl(){return this.currentUrl.replace("&kiosk","")},graphWindow(){return this.$refs.frame?.contentWindow},graphHistory(){return this.graphWindow?.history},graphDocument(){return this.graphWindow?.document}},watch:{currentUrl(e){this.graphHistory&&this.graphWindow?.angular&&this.graphWindow.location.replace(e)},error(e){e?this.errorTimer=setInterval(()=>{this.reload()},45e3):(clearInterval(this.errorTimer),this.errorTimer=null)}},mounted(){this.$refs.frame.onload=this.inject,this.poll()},beforeUnmount(){this.interval&&clearInterval(this.interval),this.errorTimer&&clearInterval(this.errorTimer)},methods:{poll(){this.interval&&(clearInterval(this.interval),this.interval=null),this.interval=setInterval(()=>{try{const e=this.$refs.frame?.contentWindow,t=e.document.querySelectorAll('[class$="alert-error'),a=e.document.querySelectorAll('[class$="panel-info-corner--error'),r=e.document.querySelectorAll('[class$="panel-in-fullscreen'),s=e.document.querySelectorAll('[class$="panel-container'),n=t.length>0||a.length>0,i=r.length>0||s.length>0,o=e.document.getElementsByTagName("pre"),l=o.length>0?o[0].innerText:"",c=l.includes('"status": "Failure"');if(n)throw new Error("An error was detected in the iframe");this["loading"]=!i,this["error"]=c}catch(e){this["error"]=!0,this["loading"]=!1,clearInterval(this.interval),this.interval=null}},100)},computeFromTo(){return{from:`now-${this.range}`,to:"now"}},computeUrl(){const e=this.url,t=this.$store.getters["currentCluster"].id,a=this.computeParams();return(0,P.l9)(this.monitoringVersion,e,t,a,this.modifyPrefix)},computeParams(){const e={},t=this.computeFromTo();return t.from&&(e.from=t.from),t.to&&(e.to=t.to),this.refreshRate&&(e.refresh=this.refreshRate),Object.keys(this.vars).length>0&&Object.entries(this.vars).forEach(t=>{const a=`var-${t[0]}`;e[a]=t[1]}),e.theme=this.theme,e},reload(e){e&&e.preventDefault(),this.$refs.frame.contentWindow.location.reload(),this.poll()},injectCss(){const e=document.createElement("style");e.innerHTML=`\n        body .grafana-app .dashboard-content {\n          background: ${this.backgroundColor};\n          padding: 0;\n        }\n\n        body .grafana-app .layout {\n          background: ${this.backgroundColor};\n        }\n\n\n        body .grafana-app .dashboard-content .panel-container {\n          background-color: initial;\n          border: none;\n        }\n\n        body .grafana-app .dashboard-content .panel-wrapper {\n          height: 100%;\n        }\n\n        body .grafana-app .panel-menu-container {\n          display: none;\n        }\n\n        body .grafana-app .panel-title {\n          cursor: default;\n        }\n\n        body .grafana-app .panel-title .panel-title-text div {\n          display: none;\n        }\n      `;const t=this.$refs.frame?.contentWindow,a=t?.document;a.head&&a.head.appendChild(e)},inject(){this.injectCss()}}};a(2271);const E=(0,g.A)(B,[["render",x],["__scopeId","data-v-2ba52de3"]]);var _=E,T=a(65359),A={components:{DashboardOptions:v,GrafanaDashboard:_},props:{detailUrl:{type:String,required:!0},summaryUrl:{type:String,default:""},vars:{type:Object,default:()=>({})},graphHeight:{type:String,required:!0},hasSummaryAndDetail:{type:Boolean,default:!0},modifyPrefix:{type:Boolean,default:!0}},data(){return{graphOptions:{range:"5m",refreshRate:"30s",type:"detail"}}},computed:{...(0,T.L8)(["prefs/theme"]),graphBackgroundColor(){return"dark"===this.theme?"#2e3035":"#f3f4f9"},theme(){return this["prefs/theme"]}}};a(35493);const F=(0,g.A)(A,[["render",i],["__scopeId","data-v-5cdbd67f"]]);var V=F},87619:function(e,t,a){"use strict";a.d(t,{A:function(){return u}});var r=a(9274);const s={key:0,class:"loading-indicator"},n={key:1};function i(e,t,a,i,o,l){const c=(0,r.resolveComponent)("t");return a.loading?((0,r.openBlock)(),(0,r.createElementBlock)("div",s,[o.showMessage?((0,r.openBlock)(),(0,r.createElementBlock)("div",{key:0,class:(0,r.normalizeClass)(["overlay",{"overlay-content-mode":"content"===a.mode,"overlay-main-mode":"main"===a.mode}])},[(0,r.createVNode)(c,{k:"generic.loading",raw:!0})],2)):(0,r.createCommentVNode)("",!0)])):((0,r.openBlock)(),(0,r.createElementBlock)("div",n,[(0,r.renderSlot)(e.$slots,"default",{},void 0,!0)]))}var o={props:{loading:{type:Boolean,default:!0},mode:{type:String,default:"content"},noDelay:{type:Boolean,default:!1}},data(){return{timer:null,showMessage:this.noDelay}},mounted(){this.timer=setTimeout(()=>{this.showMessage=!0},250)},beforeUnmount(){clearTimeout(this.timer)}},l=(a(60513),a(47433));const c=(0,l.A)(o,[["render",i],["__scopeId","data-v-fac347aa"]]);var u=c},95606:function(e,t,a){var r=a(33814);r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals);var s=a(74825).A;s("0177b65e",r,!0,{sourceMap:!1,shadowMode:!1})},95799:function(e,t,a){"use strict";a.d(t,{$W:function(){return i},Mo:function(){return n},QN:function(){return r}});const r=["","K","M","G","T","P","E","Z","Y"],s=["","m","u","n","p","f","a","z","y"];function n(e,{increment:t=1e3,addSuffix:a=!0,addSuffixSpace:o=!0,suffix:l="",firstSuffix:c=null,startingExponent:u=0,minExponent:d=0,maxExponent:h=99,maxPrecision:p=2,canRoundToZero:m=!0}={}){let g=e,f=u;const v=h>=0;if(v)while(g>=t&&f+1<r.length&&f<h||f<d)g/=t,f++;else while(g<t&&f+1<s.length&&f<-1*h||f<-1*d)g*=t,f++;let y="";if(y=g<10&&p>=1?""+Math.round(g*10**p)/10**p:`${Math.round(g)}`,"0"===y&&!m&&0!==e){const r=i(e,t);return n(e,{increment:t,addSuffix:a,suffix:l,firstSuffix:c,startingExponent:u,minExponent:r,maxExponent:r,maxPrecision:p,canRoundToZero:!0})}return a&&(o&&(y+=" "),y+=0===f&&null!==c?`${c}`:`${v?r[f]:s[f]}${l}`||""),y}function i(e,t=1e3){let a=0;while(e>=t)e/=t,a++;return a}},97348:function(e,t,a){"use strict";a.d(t,{Qr:function(){return u},l9:function(){return l}});var r=a(83416),s=a(50667),n=a(35664);const i=["100.2.0+up40.1.2","102.0.0+up40.1.2"];function o(e,t){return i.includes(e)?`/k8s/clusters/${t}`:"local"===t?"":`/k8s/clusters/${t}`}function l(e,t,a,r,n=!0){const i=(0,s.qg)(t);let l=n?`${o(e,a)}${i.path}`:i.path;return i.query.viewPanel&&(l=(0,s.R_)(l,"viewPanel",i.query.viewPanel)),l=(0,s.R_)(l,"orgId",i.query.orgId),l=(0,s.R_)(l,"kiosk",null),l=(0,s.R_)(l,"_dash.hideTimePicker","true"),Object.entries(r).forEach(e=>{l=(0,s.R_)(l,e[0],e[1])}),l}async function c(e,t,a,n,i="cluster",l=null){if(!(0,r.de)(t.getters))return!1;const c=(0,s.qg)(n);let u=`${o(e,a)}/api/v1/namespaces/cattle-monitoring-system/services/http:rancher-monitoring-grafana:80/proxy/`,d="http:rancher-monitoring-grafana:80/proxy/";l&&(u=`${o(e,a)}/api/v1/namespaces/cattle-project-${l}-monitoring/services/http:cattle-project-${l}-monitoring-grafana:80/proxy/`,d=`http:cattle-project-${l}-monitoring-grafana:80/proxy/`);const h=c.path.split(d)[1],p=h.split("/")[1],m=`${u}api/dashboards/uid/${p}`;try{return await t.dispatch(`${i}/request`,{url:m,redirectUnauthorized:!1}),!0}catch(g){return!1}}async function u(e,t,a,r="cluster",s=null){let i,o="";if(!s&&e.getters[`${r}/canList`](n.W8.APP)){try{i=await e.dispatch(`${r}/find`,{type:n.W8.APP,id:"cattle-monitoring-system/rancher-monitoring"})}catch(u){}o=i?.currentVersion}const l=a.map(a=>c(o,e,t,a,r,s));return(await Promise.all(l)).every(e=>e)}},99365:function(e,t,a){"use strict";a.r(t);var r=a(36758),s=a.n(r),n=a(40935),i=a.n(n),o=i()(s());o.push([e.id,".badge-state[data-v-544b3117]{align-items:center;display:inline-flex;padding:2px 10px;border:1px solid transparent;border-radius:20px}.badge-state.bg-info[data-v-544b3117]{color:var(--on-info-banner);background:var(--info-badge,var(--info-banner))}.badge-state.bg-error[data-v-544b3117]{color:var(--on-error-banner);background:var(--error-badge,var(--error-banner))}.badge-state.bg-warning[data-v-544b3117]{color:var(--on-warning-banner);background:var(--warning-badge,var(--warning-banner))}.badge-state.bg-success[data-v-544b3117]{color:var(--on-success-banner,var(--success-text));background:var(--success-badge,var(--success))}.badge-state.badge-disabled[data-v-544b3117]{color:var(--badge-state-disabled-text);background-color:var(--badge-state-disabled-bg);border:1px solid var(--badge-state-disabled-border)}",""]),t["default"]=o}}]);
//# sourceMappingURL=rancher-pod-metrics-1.0.0.umd.min.732.js.map