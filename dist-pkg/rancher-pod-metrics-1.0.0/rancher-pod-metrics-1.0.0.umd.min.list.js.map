{"version":3,"file":"rancher-pod-metrics-1.0.0.umd.min.list.js","mappings":"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","sources":["webpack://rancher-pod-metrics-1.0.0/./utils/metrics.ts","webpack://rancher-pod-metrics-1.0.0/./.shell/promptRemove/ sync ^\\.\\/.*$","webpack://rancher-pod-metrics-1.0.0/./list/pod.vue?c14d","webpack://rancher-pod-metrics-1.0.0/./list/pod.vue?3830","webpack://rancher-pod-metrics-1.0.0/./list/pod.vue","webpack://rancher-pod-metrics-1.0.0/./list/pod.vue?2d25","webpack://rancher-pod-metrics-1.0.0/./list/pod.vue?d069","webpack://rancher-pod-metrics-1.0.0/./.shell/assets/brand/ sync ^\\.\\/.*\\/metadata\\.json$"],"sourcesContent":["import type { PodMetricsResponse, PodMetricsItem, ParsedMetrics } from '../types/pod-metrics';\n\n/**\n * Parse CPU value from Kubernetes format to millicores\n * Examples: \"123m\" -> 123, \"1234n\" -> 0.001234, \"2\" -> 2000\n */\nexport function parseCPU(cpu: string): number {\n  if (!cpu || typeof cpu !== 'string') return 0;\n  \n  const trimmed = cpu.trim();\n  if (!trimmed) return 0;\n  \n  if (trimmed.endsWith('n')) {\n    // nanocores to millicores\n    const value = parseFloat(trimmed.slice(0, -1));\n    return isNaN(value) ? 0 : value / 1000000;\n  } else if (trimmed.endsWith('m')) {\n    // millicores\n    const value = parseFloat(trimmed.slice(0, -1));\n    return isNaN(value) ? 0 : value;\n  } else {\n    // cores to millicores\n    const value = parseFloat(trimmed);\n    return isNaN(value) ? 0 : value * 1000;\n  }\n}\n\n/**\n * Parse Memory value from Kubernetes format to MiB\n * Examples: \"123Mi\" -> 123, \"456Ki\" -> 0.445, \"1Gi\" -> 1024\n */\nexport function parseMemory(memory: string): number {\n  if (!memory || typeof memory !== 'string') return 0;\n  \n  const trimmed = memory.trim();\n  if (!trimmed) return 0;\n  \n  const units: { [key: string]: number } = {\n    'Ki': 1 / 1024,      // KiB to MiB\n    'Mi': 1,             // MiB\n    'Gi': 1024,          // GiB to MiB\n    'Ti': 1024 * 1024,   // TiB to MiB\n    'K': 1 / 1024 / 1.024, // K to MiB\n    'M': 1 / 1.024,        // M to MiB\n    'G': 1024 / 1.024,     // G to MiB\n    'T': 1024 * 1024 / 1.024 // T to MiB\n  };\n  \n  for (const [unit, multiplier] of Object.entries(units)) {\n    if (trimmed.endsWith(unit)) {\n      const value = parseFloat(trimmed.slice(0, -unit.length));\n      return isNaN(value) ? 0 : value * multiplier;\n    }\n  }\n  \n  // Plain bytes to MiB\n  const value = parseFloat(trimmed);\n  return isNaN(value) ? 0 : value / (1024 * 1024);\n}\n\n/**\n * Format CPU millicores to vCPU display\n * Always use vCPU for consistency\n */\nexport function formatCPU(millicores: number): string {\n  if (!millicores || millicores === 0) return '0.00 vCPU';\n  \n  const vCPU = millicores / 1000;\n  return `${vCPU.toFixed(2)} vCPU`;\n}\n\n/**\n * Format Memory MiB to display\n * Examples: 256 -> \"256 MiB\", 1536 -> \"1.5 GiB\"\n */\nexport function formatMemory(mib: number): string {\n  if (!mib) return '0 MiB';\n  \n  if (mib >= 1024) {\n    return `${(mib / 1024).toFixed(2)} GiB`;\n  }\n  return `${mib.toFixed(0)} MiB`;\n}\n\n/**\n * Parse pod metrics item to aggregated metrics\n */\nexport function parsePodMetrics(item: PodMetricsItem): ParsedMetrics {\n  let totalCPU = 0;\n  let totalMemory = 0;\n  \n  // Validate input\n  if (!item || !item.containers || !Array.isArray(item.containers)) {\n    return {\n      cpu: 0,\n      memory: 0,\n      cpuDisplay: '0.00 vCPU',\n      memoryDisplay: '0 MiB'\n    };\n  }\n  \n  // Sum all container metrics\n  for (const container of item.containers) {\n    if (container && container.usage) {\n      totalCPU += parseCPU(container.usage.cpu);\n      totalMemory += parseMemory(container.usage.memory);\n    }\n  }\n  \n  return {\n    cpu: totalCPU,\n    memory: totalMemory,\n    cpuDisplay: formatCPU(totalCPU),\n    memoryDisplay: formatMemory(totalMemory)\n  };\n}\n\n/**\n * Fetch pod metrics from metrics.k8s.io API\n */\nexport async function fetchPodMetrics(\n  axios: any,\n  clusterId: string,\n  namespace?: string\n): Promise<Map<string, ParsedMetrics>> {\n  const metricsMap = new Map<string, ParsedMetrics>();\n  \n  // Validate inputs\n  if (!axios || !clusterId) {\n    console.error('Invalid parameters for fetchPodMetrics');\n    return metricsMap;\n  }\n  \n  try {\n    // Build API URL\n    const baseUrl = `/k8s/clusters/${clusterId}/apis/metrics.k8s.io/v1beta1`;\n    const url = namespace \n      ? `${baseUrl}/namespaces/${namespace}/pods`\n      : `${baseUrl}/pods`;\n    \n    const response = await axios.get(url);\n    const data = response.data as PodMetricsResponse;\n    \n    // Validate response structure\n    if (data && data.items && Array.isArray(data.items)) {\n      for (const item of data.items) {\n        // Validate item has required metadata\n        if (item.metadata && item.metadata.namespace && item.metadata.name) {\n          const key = `${item.metadata.namespace}/${item.metadata.name}`;\n          metricsMap.set(key, parsePodMetrics(item));\n        }\n      }\n    }\n  } catch (error: any) {\n    // Log error but don't throw - return empty map to allow UI to handle gracefully\n    const errorMessage = error.message || 'Unknown error';\n    console.error('Failed to fetch pod metrics:', errorMessage);\n  }\n  \n  return metricsMap;\n}\n","var map = {\n\t\"./management.cattle.io.fleetworkspace\": 75593,\n\t\"./management.cattle.io.fleetworkspace.vue\": 75593,\n\t\"./management.cattle.io.globalrole\": 39126,\n\t\"./management.cattle.io.globalrole.vue\": 39126,\n\t\"./management.cattle.io.project\": 11193,\n\t\"./management.cattle.io.project.vue\": 11193,\n\t\"./management.cattle.io.roletemplate\": 24093,\n\t\"./management.cattle.io.roletemplate.vue\": 24093,\n\t\"./mixin/roleDeletionCheck\": 93097,\n\t\"./mixin/roleDeletionCheck.js\": 93097,\n\t\"./pod\": 4563,\n\t\"./pod.vue\": 4563\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 39989;","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".text-muted[data-v-08f81b18]{color:var(--muted)}.text-error[data-v-08f81b18]{color:var(--error);cursor:help}.icon-spin[data-v-08f81b18]{animation:spin-08f81b18 1s linear infinite}@keyframes spin-08f81b18{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"text-muted\"\n}\nconst _hoisted_2 = [\"title\"]\nconst _hoisted_3 = [\"title\"]\nconst _hoisted_4 = {\n  key: 0,\n  class: \"text-muted\"\n}\nconst _hoisted_5 = [\"title\"]\nconst _hoisted_6 = [\"title\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ResourceTable = _resolveComponent(\"ResourceTable\")!\n\n  return (_openBlock(), _createBlock(_component_ResourceTable, {\n    schema: _ctx.schema,\n    headers: _ctx.headers,\n    \"key-field\": \"id\"\n  }, {\n    \"cell:cpu\": _withCtx(({ row }) => [\n      (_ctx.metricsLoading && _ctx.metricsMap.size === 0)\n        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_1, _cache[0] || (_cache[0] = [\n            _createElementVNode(\"i\", { class: \"icon icon-spinner icon-spin\" }, null, -1)\n          ])))\n        : (_ctx.metricsError)\n          ? (_openBlock(), _createElementBlock(\"span\", {\n              key: 1,\n              class: \"text-error\",\n              title: _ctx.metricsError\n            }, \" Error \", 8, _hoisted_2))\n          : (_openBlock(), _createElementBlock(\"span\", {\n              key: 2,\n              title: `${_ctx.getMetricsForPod(row).cpu} millicores`\n            }, _toDisplayString(_ctx.getMetricsForPod(row).cpuDisplay), 9, _hoisted_3))\n    ]),\n    \"cell:memory\": _withCtx(({ row }) => [\n      (_ctx.metricsLoading && _ctx.metricsMap.size === 0)\n        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _cache[1] || (_cache[1] = [\n            _createElementVNode(\"i\", { class: \"icon icon-spinner icon-spin\" }, null, -1)\n          ])))\n        : (_ctx.metricsError)\n          ? (_openBlock(), _createElementBlock(\"span\", {\n              key: 1,\n              class: \"text-error\",\n              title: _ctx.metricsError\n            }, \" Error \", 8, _hoisted_5))\n          : (_openBlock(), _createElementBlock(\"span\", {\n              key: 2,\n              title: `${_ctx.getMetricsForPod(row).memory} MiB`\n            }, _toDisplayString(_ctx.getMetricsForPod(row).memoryDisplay), 9, _hoisted_6))\n    ]),\n    _: 1\n  }, 8, [\"schema\", \"headers\"]))\n}","<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport ResourceTable from '@shell/components/ResourceTable.vue';\nimport { fetchPodMetrics } from '../utils/metrics';\nimport type { ParsedMetrics } from '../types/pod-metrics';\n\nexport default defineComponent({\n  name: 'PodListWithMetrics',\n  components: { ResourceTable },\n\n  props: {\n    // Standard props passed by Rancher to list components\n    resource: {\n      type: String,\n      required: true\n    },\n    schema: {\n      type: Object,\n      default: null\n    }\n  },\n\n  data() {\n    return {\n      metricsMap: new Map<string, ParsedMetrics>(),\n      metricsLoading: false,\n      metricsError: null as string | null,\n      refreshInterval: null as number | null,\n      lastFetchTime: 0, // Track last fetch to prevent duplicate requests\n      storeUnwatch: null as any // Vuex store unwatch function\n    };\n  },\n\n  computed: {\n    // Get current cluster ID from route\n    clusterId(): string {\n      const cluster = this.$route.params.cluster;\n      return Array.isArray(cluster) ? cluster[0] : (cluster || 'local');\n    },\n\n    // Extended headers with CPU and RAM columns\n    headers() {\n      const baseHeaders = this.defaultHeaders || [];\n      \n      // Find position: Insert after Node column, before Age column\n      const nodeIndex = baseHeaders.findIndex((h: any) => h.name === 'node');\n      const ageIndex = baseHeaders.findIndex((h: any) => h.name === 'age');\n      \n      // Determine insert position\n      // We want: ... Node | CPU | RAM | Age ...\n      let insertIndex = baseHeaders.length;\n      \n      if (ageIndex >= 0) {\n        // Insert before Age\n        insertIndex = ageIndex;\n      } else if (nodeIndex >= 0) {\n        // Insert after Node if Age not found\n        insertIndex = nodeIndex + 1;\n      }\n      \n      const metricsHeaders = [\n        {\n          name: 'cpu',\n          label: 'CPU',\n          value: 'cpu',\n          sort: ['cpu'],\n          width: 120\n        },\n        {\n          name: 'memory',\n          label: 'RAM',\n          value: 'memory',\n          sort: ['memory'],\n          width: 120\n        }\n      ];\n      \n      return [\n        ...baseHeaders.slice(0, insertIndex),\n        ...metricsHeaders,\n        ...baseHeaders.slice(insertIndex)\n      ];\n    },\n\n    // Get default headers from ResourceTable\n    defaultHeaders(): any[] {\n      return this.$store.getters['type-map/headersFor'](this.schema) || [];\n    }\n  },\n\n  mounted() {\n    // Initial metrics fetch\n    this.loadMetrics();\n    \n    // Listen to Pod resource changes via Vuex store\n    // This aligns with Rancher's WebSocket-based updates\n    this.setupStoreWatch();\n    \n    // Fallback polling for metrics-only updates (10s)\n    // Since metrics.k8s.io doesn't support WebSocket watch\n    this.startPolling(10000);\n    \n    // Listen to tab visibility changes for adaptive polling\n    document.addEventListener('visibilitychange', this.handleVisibilityChange);\n  },\n\n  beforeUnmount() {\n    this.stopPolling();\n    this.stopStoreWatch();\n    document.removeEventListener('visibilitychange', this.handleVisibilityChange);\n  },\n\n  methods: {\n    /**\n     * Get metrics for a specific pod\n     */\n    getMetricsForPod(pod: any): ParsedMetrics {\n      const key = `${pod.metadata?.namespace}/${pod.metadata?.name}`;\n      const metrics = this.metricsMap.get(key);\n      \n      return metrics || { \n        cpu: 0, \n        memory: 0, \n        cpuDisplay: '0.00 vCPU', \n        memoryDisplay: '0 MiB' \n      };\n    },\n\n    /**\n     * Start polling with specified interval\n     */\n    startPolling(interval: number = 10000) {\n      this.stopPolling();\n      this.refreshInterval = window.setInterval(() => {\n        this.loadMetrics();\n      }, interval);\n    },\n\n    /**\n     * Stop polling\n     */\n    stopPolling() {\n      if (this.refreshInterval) {\n        clearInterval(this.refreshInterval);\n        this.refreshInterval = null;\n      }\n    },\n\n    /**\n     * Setup Vuex store watch to detect Pod changes\n     * This aligns with Rancher's WebSocket-based resource updates\n     */\n    setupStoreWatch() {\n      // Watch for Pod resource changes in the store\n      // When Pods are updated via WebSocket, refresh metrics\n      this.storeUnwatch = this.$store.watch(\n        (state: any, getters: any) => {\n          // Watch the pods collection revision\n          const pods = getters['cluster/all']('pod');\n          return pods?.length || 0;\n        },\n        (newVal: number, oldVal: number) => {\n          // Only refresh if pod count changed (new pod added/removed)\n          if (newVal !== oldVal) {\n            this.loadMetrics();\n          }\n        }\n      );\n    },\n\n    /**\n     * Stop store watch\n     */\n    stopStoreWatch() {\n      if (this.storeUnwatch) {\n        this.storeUnwatch();\n        this.storeUnwatch = null;\n      }\n    },\n\n    /**\n     * Handle tab visibility change for adaptive polling\n     */\n    handleVisibilityChange() {\n      if (document.hidden) {\n        // Tab inactive → slow down to 60s to save resources\n        this.startPolling(60000);\n      } else {\n        // Tab active → back to 10s\n        // Don't refresh immediately to avoid duplicate with ongoing interval\n        this.startPolling(10000);\n      }\n    },\n\n    /**\n     * Load metrics from metrics.k8s.io API\n     * Includes deduplication to prevent multiple simultaneous requests\n     */\n    async loadMetrics() {\n      // Prevent duplicate requests within 2 seconds\n      const now = Date.now();\n      if (this.metricsLoading || (now - this.lastFetchTime < 2000)) {\n        return;\n      }\n      \n      try {\n        this.metricsLoading = true;\n        this.metricsError = null;\n        this.lastFetchTime = now;\n        \n        const metrics = await fetchPodMetrics(\n          this.$store.$axios,\n          this.clusterId\n        );\n        \n        this.metricsMap = metrics;\n      } catch (error: any) {\n        console.error('[PodMetrics] Error loading metrics:', error);\n        this.metricsError = error.message || 'Failed to load metrics';\n      } finally {\n        this.metricsLoading = false;\n      }\n    }\n  }\n});\n</script>\n\n<template>\n  <ResourceTable\n    :schema=\"schema\"\n    :headers=\"headers\"\n    key-field=\"id\"\n  >\n    <!-- Custom cell formatters for CPU -->\n    <template #cell:cpu=\"{ row }\">\n      <span v-if=\"metricsLoading && metricsMap.size === 0\" class=\"text-muted\">\n        <i class=\"icon icon-spinner icon-spin\" />\n      </span>\n      <span v-else-if=\"metricsError\" class=\"text-error\" :title=\"metricsError\">\n        Error\n      </span>\n      <span v-else :title=\"`${getMetricsForPod(row).cpu} millicores`\">\n        {{ getMetricsForPod(row).cpuDisplay }}\n      </span>\n    </template>\n\n    <!-- Custom cell formatters for RAM -->\n    <template #cell:memory=\"{ row }\">\n      <span v-if=\"metricsLoading && metricsMap.size === 0\" class=\"text-muted\">\n        <i class=\"icon icon-spinner icon-spin\" />\n      </span>\n      <span v-else-if=\"metricsError\" class=\"text-error\" :title=\"metricsError\">\n        Error\n      </span>\n      <span v-else :title=\"`${getMetricsForPod(row).memory} MiB`\">\n        {{ getMetricsForPod(row).memoryDisplay }}\n      </span>\n    </template>\n  </ResourceTable>\n</template>\n\n<style lang=\"scss\" scoped>\n.text-muted {\n  color: var(--muted);\n}\n\n.text-error {\n  color: var(--error);\n  cursor: help;\n}\n\n.icon-spin {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import { render } from \"./pod.vue?vue&type=template&id=08f81b18&scoped=true&ts=true\"\nimport script from \"./pod.vue?vue&type=script&lang=ts\"\nexport * from \"./pod.vue?vue&type=script&lang=ts\"\n\nimport \"./pod.vue?vue&type=style&index=0&id=08f81b18&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-08f81b18\"]])\n\nexport default __exports__","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./pod.vue?vue&type=style&index=0&id=08f81b18&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"026a5653\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var map = {\n\t\"./classic/metadata.json\": 29621,\n\t\"./csp/metadata.json\": 6471,\n\t\"./federal/metadata.json\": 91862,\n\t\"./harvester/metadata.json\": 51507,\n\t\"./rgs/metadata.json\": 48401,\n\t\"./suse/metadata.json\": 37259\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 93558;"],"names":["parseCPU","cpu","trimmed","trim","endsWith","value","parseFloat","slice","isNaN","parseMemory","memory","units","unit","multiplier","Object","entries","length","formatCPU","millicores","vCPU","toFixed","formatMemory","mib","parsePodMetrics","item","totalCPU","totalMemory","containers","Array","isArray","cpuDisplay","memoryDisplay","container","usage","async","fetchPodMetrics","axios","clusterId","namespace","metricsMap","Map","console","error","baseUrl","url","response","get","data","items","metadata","name","key","set","errorMessage","message","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","resolve","module","exports","___CSS_LOADER_EXPORT___","push","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","render","_ctx","_cache","$props","$setup","$data","$options","_component_ResourceTable","_resolveComponent","_openBlock","_createBlock","schema","headers","_withCtx","row","metricsLoading","size","_createElementBlock","_createElementVNode","metricsError","title","getMetricsForPod","_toDisplayString","_","defineComponent","components","ResourceTable","props","resource","type","String","required","default","refreshInterval","lastFetchTime","storeUnwatch","computed","cluster","this","$route","params","baseHeaders","defaultHeaders","nodeIndex","findIndex","h","ageIndex","insertIndex","metricsHeaders","label","sort","width","$store","getters","mounted","loadMetrics","setupStoreWatch","startPolling","document","addEventListener","handleVisibilityChange","beforeUnmount","stopPolling","stopStoreWatch","removeEventListener","methods","pod","metrics","interval","window","setInterval","clearInterval","watch","state","pods","newVal","oldVal","hidden","now","Date","$axios","__exports__","content","__esModule","locals","add"],"ignoreList":[],"sourceRoot":""}