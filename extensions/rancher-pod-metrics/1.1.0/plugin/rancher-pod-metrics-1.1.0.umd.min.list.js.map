{"version":3,"file":"rancher-pod-metrics-1.1.0.umd.min.list.js","mappings":"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","sources":["webpack://rancher-pod-metrics-1.1.0/./list/pod.vue?3489","webpack://rancher-pod-metrics-1.1.0/./list/pod.vue","webpack://rancher-pod-metrics-1.1.0/./list/pod.vue?2d25","webpack://rancher-pod-metrics-1.1.0/./utils/metrics.ts","webpack://rancher-pod-metrics-1.1.0/./.shell/promptRemove/ sync ^\\.\\/.*$","webpack://rancher-pod-metrics-1.1.0/./list/pod.vue?9d65","webpack://rancher-pod-metrics-1.1.0/./list/pod.vue?4aa8","webpack://rancher-pod-metrics-1.1.0/./.shell/assets/brand/ sync ^\\.\\/.*\\/metadata\\.json$"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  class: \"text-muted\"\n}\nconst _hoisted_2 = [\"title\"]\nconst _hoisted_3 = [\"title\"]\nconst _hoisted_4 = {\n  key: 0,\n  class: \"text-muted\"\n}\nconst _hoisted_5 = [\"title\"]\nconst _hoisted_6 = [\"title\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ResourceTable = _resolveComponent(\"ResourceTable\")!\n\n  return (_openBlock(), _createBlock(_component_ResourceTable, {\n    schema: _ctx.schema,\n    headers: _ctx.headers,\n    \"key-field\": \"id\"\n  }, {\n    \"cell:cpu\": _withCtx(({ row }) => [\n      (_ctx.metricsLoading && _ctx.metricsMap.size === 0)\n        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_1, _cache[0] || (_cache[0] = [\n            _createElementVNode(\"i\", { class: \"icon icon-spinner icon-spin\" }, null, -1)\n          ])))\n        : (_ctx.metricsError)\n          ? (_openBlock(), _createElementBlock(\"span\", {\n              key: 1,\n              class: \"text-error\",\n              title: _ctx.metricsError\n            }, \" Error \", 8, _hoisted_2))\n          : (_openBlock(), _createElementBlock(\"span\", {\n              key: 2,\n              title: `${_ctx.getMetricsForPod(row).cpu} millicores`\n            }, _toDisplayString(_ctx.getMetricsForPod(row).cpuDisplay), 9, _hoisted_3))\n    ]),\n    \"cell:memory\": _withCtx(({ row }) => [\n      (_ctx.metricsLoading && _ctx.metricsMap.size === 0)\n        ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _cache[1] || (_cache[1] = [\n            _createElementVNode(\"i\", { class: \"icon icon-spinner icon-spin\" }, null, -1)\n          ])))\n        : (_ctx.metricsError)\n          ? (_openBlock(), _createElementBlock(\"span\", {\n              key: 1,\n              class: \"text-error\",\n              title: _ctx.metricsError\n            }, \" Error \", 8, _hoisted_5))\n          : (_openBlock(), _createElementBlock(\"span\", {\n              key: 2,\n              title: `${_ctx.getMetricsForPod(row).memory} MiB`\n            }, _toDisplayString(_ctx.getMetricsForPod(row).memoryDisplay), 9, _hoisted_6))\n    ]),\n    _: 1\n  }, 8, [\"schema\", \"headers\"]))\n}","<script lang=\"ts\">\nimport { defineComponent } from 'vue';\nimport ResourceTable from '@shell/components/ResourceTable.vue';\nimport { fetchPodMetrics } from '../utils/metrics';\nimport type { ParsedMetrics } from '../types/pod-metrics';\n\nexport default defineComponent({\n  name: 'PodListWithMetrics',\n  components: { ResourceTable },\n\n  props: {\n    // Standard props passed by Rancher to list components\n    resource: {\n      type: String,\n      required: true\n    },\n    schema: {\n      type: Object,\n      default: null\n    }\n  },\n\n  data() {\n    return {\n      metricsMap: new Map<string, ParsedMetrics>(),\n      metricsLoading: false,\n      metricsError: null as string | null,\n      refreshInterval: null as number | null,\n      lastFetchTime: 0, // Track last fetch to prevent duplicate requests\n      storeUnwatch: null as any // Vuex store unwatch function\n    };\n  },\n\n  computed: {\n    // Get current cluster ID from route\n    clusterId(): string {\n      const cluster = this.$route.params.cluster;\n      return Array.isArray(cluster) ? cluster[0] : (cluster || 'local');\n    },\n\n    // Extended headers with CPU and RAM columns\n    headers() {\n      const baseHeaders = this.defaultHeaders || [];\n      \n      // Find position: Insert after Node column, before Age column\n      const nodeIndex = baseHeaders.findIndex((h: any) => h.name === 'node');\n      const ageIndex = baseHeaders.findIndex((h: any) => h.name === 'age');\n      \n      // Determine insert position\n      // We want: ... Node | CPU | RAM | Age ...\n      let insertIndex = baseHeaders.length;\n      \n      if (ageIndex >= 0) {\n        // Insert before Age\n        insertIndex = ageIndex;\n      } else if (nodeIndex >= 0) {\n        // Insert after Node if Age not found\n        insertIndex = nodeIndex + 1;\n      }\n      \n      const metricsHeaders = [\n        {\n          name: 'cpu',\n          label: 'CPU',\n          value: 'cpu',\n          sort: ['cpu'],\n          width: 120\n        },\n        {\n          name: 'memory',\n          label: 'RAM',\n          value: 'memory',\n          sort: ['memory'],\n          width: 120\n        }\n      ];\n      \n      return [\n        ...baseHeaders.slice(0, insertIndex),\n        ...metricsHeaders,\n        ...baseHeaders.slice(insertIndex)\n      ];\n    },\n\n    // Get default headers from ResourceTable\n    defaultHeaders(): any[] {\n      return this.$store.getters['type-map/headersFor'](this.schema) || [];\n    }\n  },\n\n  mounted() {\n    // Initial metrics fetch\n    this.loadMetrics();\n    \n    // Listen to Pod resource changes via Vuex store\n    // This aligns with Rancher's WebSocket-based updates\n    this.setupStoreWatch();\n    \n    // Fallback polling for metrics-only updates (30s)\n    // Since metrics.k8s.io doesn't support WebSocket watch\n    // Reduced from 10s to 30s to minimize API spam - metrics don't change that frequently\n    this.startPolling(30000);\n    \n    // Listen to tab visibility changes for adaptive polling\n    document.addEventListener('visibilitychange', this.handleVisibilityChange);\n  },\n\n  beforeUnmount() {\n    this.stopPolling();\n    this.stopStoreWatch();\n    document.removeEventListener('visibilitychange', this.handleVisibilityChange);\n  },\n\n  methods: {\n    /**\n     * Get metrics for a specific pod\n     */\n    getMetricsForPod(pod: any): ParsedMetrics {\n      const key = `${pod.metadata?.namespace}/${pod.metadata?.name}`;\n      const metrics = this.metricsMap.get(key);\n      \n      return metrics || { \n        cpu: 0, \n        memory: 0, \n        cpuDisplay: '0.00 vCPU', \n        memoryDisplay: '0 MiB' \n      };\n    },\n\n    /**\n     * Start polling with specified interval\n     */\n    startPolling(interval: number = 30000) {\n      this.stopPolling();\n      this.refreshInterval = window.setInterval(() => {\n        this.loadMetrics();\n      }, interval);\n    },\n\n    /**\n     * Stop polling\n     */\n    stopPolling() {\n      if (this.refreshInterval) {\n        clearInterval(this.refreshInterval);\n        this.refreshInterval = null;\n      }\n    },\n\n    /**\n     * Setup Vuex store watch to detect Pod changes\n     * This aligns with Rancher's WebSocket-based resource updates\n     */\n    setupStoreWatch() {\n      // Watch for Pod resource changes in the store\n      // When Pods are updated via WebSocket, refresh metrics\n      this.storeUnwatch = this.$store.watch(\n        (state: any, getters: any) => {\n          // Watch the pods collection revision\n          const pods = getters['cluster/all']('pod');\n          return pods?.length || 0;\n        },\n        (newVal: number, oldVal: number) => {\n          // Only refresh if pod count changed (new pod added/removed)\n          if (newVal !== oldVal) {\n            this.loadMetrics();\n          }\n        }\n      );\n    },\n\n    /**\n     * Stop store watch\n     */\n    stopStoreWatch() {\n      if (this.storeUnwatch) {\n        this.storeUnwatch();\n        this.storeUnwatch = null;\n      }\n    },\n\n    /**\n     * Handle tab visibility change for adaptive polling\n     */\n    handleVisibilityChange() {\n      if (document.hidden) {\n        // Tab inactive → slow down to 60s to save resources\n        this.startPolling(60000);\n      } else {\n        // Tab active → back to 30s (reduced from 10s)\n        this.startPolling(30000);\n      }\n    },\n\n    /**\n     * Load metrics from metrics.k8s.io API\n     * Includes deduplication to prevent multiple simultaneous requests\n     */\n    async loadMetrics() {\n      // Prevent duplicate requests within 2 seconds\n      const now = Date.now();\n      if (this.metricsLoading || (now - this.lastFetchTime < 2000)) {\n        return;\n      }\n      \n      try {\n        this.metricsLoading = true;\n        this.metricsError = null;\n        this.lastFetchTime = now;\n        \n        const metrics = await fetchPodMetrics(\n          this.$store.$axios,\n          this.clusterId\n        );\n        \n        this.metricsMap = metrics;\n      } catch (error: any) {\n        console.error('[PodMetrics] Error loading metrics:', error);\n        this.metricsError = error.message || 'Failed to load metrics';\n      } finally {\n        this.metricsLoading = false;\n      }\n    }\n  }\n});\n</script>\n\n<template>\n  <ResourceTable\n    :schema=\"schema\"\n    :headers=\"headers\"\n    key-field=\"id\"\n  >\n    <!-- Custom cell formatters for CPU -->\n    <template #cell:cpu=\"{ row }\">\n      <span v-if=\"metricsLoading && metricsMap.size === 0\" class=\"text-muted\">\n        <i class=\"icon icon-spinner icon-spin\" />\n      </span>\n      <span v-else-if=\"metricsError\" class=\"text-error\" :title=\"metricsError\">\n        Error\n      </span>\n      <span v-else :title=\"`${getMetricsForPod(row).cpu} millicores`\">\n        {{ getMetricsForPod(row).cpuDisplay }}\n      </span>\n    </template>\n\n    <!-- Custom cell formatters for RAM -->\n    <template #cell:memory=\"{ row }\">\n      <span v-if=\"metricsLoading && metricsMap.size === 0\" class=\"text-muted\">\n        <i class=\"icon icon-spinner icon-spin\" />\n      </span>\n      <span v-else-if=\"metricsError\" class=\"text-error\" :title=\"metricsError\">\n        Error\n      </span>\n      <span v-else :title=\"`${getMetricsForPod(row).memory} MiB`\">\n        {{ getMetricsForPod(row).memoryDisplay }}\n      </span>\n    </template>\n  </ResourceTable>\n</template>\n\n<style lang=\"scss\" scoped>\n.text-muted {\n  color: var(--muted);\n}\n\n.text-error {\n  color: var(--error);\n  cursor: help;\n}\n\n.icon-spin {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n</style>\n","import { render } from \"./pod.vue?vue&type=template&id=3872bb06&scoped=true&ts=true\"\nimport script from \"./pod.vue?vue&type=script&lang=ts\"\nexport * from \"./pod.vue?vue&type=script&lang=ts\"\n\nimport \"./pod.vue?vue&type=style&index=0&id=3872bb06&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3872bb06\"]])\n\nexport default __exports__","import type { PodMetricsResponse, PodMetricsItem, ParsedMetrics } from '../types/pod-metrics';\n\n/**\n * Parse CPU value from Kubernetes format to millicores\n * Examples: \"123m\" -> 123, \"1234n\" -> 0.001234, \"2\" -> 2000\n */\nexport function parseCPU(cpu: string): number {\n  if (!cpu || typeof cpu !== 'string') return 0;\n  \n  const trimmed = cpu.trim();\n  if (!trimmed) return 0;\n  \n  if (trimmed.endsWith('n')) {\n    // nanocores to millicores\n    const value = parseFloat(trimmed.slice(0, -1));\n    return isNaN(value) ? 0 : value / 1000000;\n  } else if (trimmed.endsWith('m')) {\n    // millicores\n    const value = parseFloat(trimmed.slice(0, -1));\n    return isNaN(value) ? 0 : value;\n  } else {\n    // cores to millicores\n    const value = parseFloat(trimmed);\n    return isNaN(value) ? 0 : value * 1000;\n  }\n}\n\n/**\n * Parse Memory value from Kubernetes format to MiB\n * Examples: \"123Mi\" -> 123, \"456Ki\" -> 0.445, \"1Gi\" -> 1024\n */\nexport function parseMemory(memory: string): number {\n  if (!memory || typeof memory !== 'string') return 0;\n  \n  const trimmed = memory.trim();\n  if (!trimmed) return 0;\n  \n  const units: { [key: string]: number } = {\n    'Ki': 1 / 1024,      // KiB to MiB\n    'Mi': 1,             // MiB\n    'Gi': 1024,          // GiB to MiB\n    'Ti': 1024 * 1024,   // TiB to MiB\n    'K': 1 / 1024 / 1.024, // K to MiB\n    'M': 1 / 1.024,        // M to MiB\n    'G': 1024 / 1.024,     // G to MiB\n    'T': 1024 * 1024 / 1.024 // T to MiB\n  };\n  \n  for (const [unit, multiplier] of Object.entries(units)) {\n    if (trimmed.endsWith(unit)) {\n      const value = parseFloat(trimmed.slice(0, -unit.length));\n      return isNaN(value) ? 0 : value * multiplier;\n    }\n  }\n  \n  // Plain bytes to MiB\n  const value = parseFloat(trimmed);\n  return isNaN(value) ? 0 : value / (1024 * 1024);\n}\n\n/**\n * Format CPU millicores to vCPU display\n * Always use vCPU for consistency\n */\nexport function formatCPU(millicores: number): string {\n  if (!millicores || millicores === 0) return '0.00 vCPU';\n  \n  const vCPU = millicores / 1000;\n  return `${vCPU.toFixed(2)} vCPU`;\n}\n\n/**\n * Format Memory MiB to display\n * Examples: 256 -> \"256 MiB\", 1536 -> \"1.5 GiB\"\n */\nexport function formatMemory(mib: number): string {\n  if (!mib) return '0 MiB';\n  \n  if (mib >= 1024) {\n    return `${(mib / 1024).toFixed(2)} GiB`;\n  }\n  return `${mib.toFixed(0)} MiB`;\n}\n\n/**\n * Parse pod metrics item to aggregated metrics\n */\nexport function parsePodMetrics(item: PodMetricsItem): ParsedMetrics {\n  let totalCPU = 0;\n  let totalMemory = 0;\n  \n  // Validate input\n  if (!item || !item.containers || !Array.isArray(item.containers)) {\n    return {\n      cpu: 0,\n      memory: 0,\n      cpuDisplay: '0.00 vCPU',\n      memoryDisplay: '0 MiB'\n    };\n  }\n  \n  // Sum all container metrics\n  for (const container of item.containers) {\n    if (container && container.usage) {\n      totalCPU += parseCPU(container.usage.cpu);\n      totalMemory += parseMemory(container.usage.memory);\n    }\n  }\n  \n  return {\n    cpu: totalCPU,\n    memory: totalMemory,\n    cpuDisplay: formatCPU(totalCPU),\n    memoryDisplay: formatMemory(totalMemory)\n  };\n}\n\n/**\n * Fetch pod metrics from metrics.k8s.io API\n */\nexport async function fetchPodMetrics(\n  axios: any,\n  clusterId: string,\n  namespace?: string\n): Promise<Map<string, ParsedMetrics>> {\n  const metricsMap = new Map<string, ParsedMetrics>();\n  \n  // Validate inputs\n  if (!axios || !clusterId) {\n    console.error('Invalid parameters for fetchPodMetrics');\n    return metricsMap;\n  }\n  \n  try {\n    // Build API URL\n    const baseUrl = `/k8s/clusters/${clusterId}/apis/metrics.k8s.io/v1beta1`;\n    const url = namespace \n      ? `${baseUrl}/namespaces/${namespace}/pods`\n      : `${baseUrl}/pods`;\n    \n    const response = await axios.get(url);\n    const data = response.data as PodMetricsResponse;\n    \n    // Validate response structure\n    if (data && data.items && Array.isArray(data.items)) {\n      for (const item of data.items) {\n        // Validate item has required metadata\n        if (item.metadata && item.metadata.namespace && item.metadata.name) {\n          const key = `${item.metadata.namespace}/${item.metadata.name}`;\n          metricsMap.set(key, parsePodMetrics(item));\n        }\n      }\n    }\n  } catch (error: any) {\n    // Log error but don't throw - return empty map to allow UI to handle gracefully\n    const errorMessage = error.message || 'Unknown error';\n    console.error('Failed to fetch pod metrics:', errorMessage);\n  }\n  \n  return metricsMap;\n}\n","var map = {\n\t\"./management.cattle.io.fleetworkspace\": 75593,\n\t\"./management.cattle.io.fleetworkspace.vue\": 75593,\n\t\"./management.cattle.io.globalrole\": 39126,\n\t\"./management.cattle.io.globalrole.vue\": 39126,\n\t\"./management.cattle.io.project\": 11193,\n\t\"./management.cattle.io.project.vue\": 11193,\n\t\"./management.cattle.io.roletemplate\": 24093,\n\t\"./management.cattle.io.roletemplate.vue\": 24093,\n\t\"./mixin/roleDeletionCheck\": 93097,\n\t\"./mixin/roleDeletionCheck.js\": 93097,\n\t\"./pod\": 4563,\n\t\"./pod.vue\": 4563\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 39989;","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".text-muted[data-v-3872bb06]{color:var(--muted)}.text-error[data-v-3872bb06]{color:var(--error);cursor:help}.icon-spin[data-v-3872bb06]{animation:spin-3872bb06 1s linear infinite}@keyframes spin-3872bb06{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./pod.vue?vue&type=style&index=0&id=3872bb06&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"647c6b42\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","var map = {\n\t\"./classic/metadata.json\": 29621,\n\t\"./csp/metadata.json\": 6471,\n\t\"./federal/metadata.json\": 91862,\n\t\"./harvester/metadata.json\": 51507,\n\t\"./rgs/metadata.json\": 48401,\n\t\"./suse/metadata.json\": 37259\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 93558;"],"names":["_hoisted_1","key","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","render","_ctx","_cache","$props","$setup","$data","$options","_component_ResourceTable","_resolveComponent","_openBlock","_createBlock","schema","headers","_withCtx","row","metricsLoading","metricsMap","size","_createElementBlock","_createElementVNode","metricsError","title","getMetricsForPod","cpu","_toDisplayString","cpuDisplay","memory","memoryDisplay","_","defineComponent","name","components","ResourceTable","props","resource","type","String","required","Object","default","data","Map","refreshInterval","lastFetchTime","storeUnwatch","computed","clusterId","cluster","this","$route","params","Array","isArray","baseHeaders","defaultHeaders","nodeIndex","findIndex","h","ageIndex","insertIndex","length","metricsHeaders","label","value","sort","width","slice","$store","getters","mounted","loadMetrics","setupStoreWatch","startPolling","document","addEventListener","handleVisibilityChange","beforeUnmount","stopPolling","stopStoreWatch","removeEventListener","methods","pod","metadata","namespace","metrics","get","interval","window","setInterval","clearInterval","watch","state","pods","newVal","oldVal","hidden","now","Date","fetchPodMetrics","$axios","error","console","message","__exports__","parseCPU","trimmed","trim","endsWith","parseFloat","isNaN","parseMemory","units","unit","multiplier","entries","formatCPU","millicores","vCPU","toFixed","formatMemory","mib","parsePodMetrics","item","totalCPU","totalMemory","containers","container","usage","async","axios","baseUrl","url","response","items","set","errorMessage","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","resolve","module","exports","___CSS_LOADER_EXPORT___","push","content","__esModule","locals","add"],"ignoreList":[],"sourceRoot":""}